!function(){"use strict";const e={};function n(n,r,o){const i=e[n];if(!i)return;const s=document.getElementById(n),a=(s.querySelector(".pr-single-carousel-track"),s.querySelector(".pr-single-prev-btn")),l=s.querySelector(".pr-single-next-btn");a&&a.addEventListener("click",()=>{i.currentIndex>0&&(i.currentIndex--,t(n))}),l&&l.addEventListener("click",()=>{i.currentIndex<i.totalItems-1&&(i.currentIndex++,t(n))}),i.autoAdvance&&i.totalItems>1&&(i.autoAdvanceInterval=setInterval(()=>{i.currentIndex<i.totalItems-1?i.currentIndex++:i.currentIndex=0,t(n)},1e3*i.slideshowSpeed)),t(n)}function t(n){const r=e[n];if(!r)return;const o=document.getElementById(n),i=o.querySelector(".pr-single-carousel-track");if(!i)return;r.itemsPerView=1;const s=o.querySelector(".pr-single-carousel-item");if(!s)return;const a=window.getComputedStyle(i).gap,l=parseFloat(a)||0,c=s.offsetWidth+l,d=-r.currentIndex*c;i.style.transform=`translateX(${d}px)`,function(n){const r=e[n];if(!r)return;const o=document.getElementById(n),i=o.querySelector(".pr-single-dots-container");if(!i)return;i.innerHTML="";for(let e=0;e<r.totalItems;e++){const o=document.createElement("button");o.className="pr-single-dot "+(e===r.currentIndex?"active":""),o.style.backgroundColor=e===r.currentIndex?"#4f46e5":"#d1d5db",o.addEventListener("click",()=>{r.currentIndex=e,t(n)}),i.appendChild(o)}}(n),function(n){const t=e[n];if(!t)return;const r=document.getElementById(n),o=r.querySelector(".pr-single-prev-btn"),i=r.querySelector(".pr-single-next-btn");o&&(o.style.opacity=0===t.currentIndex?"0.5":"1",o.disabled=0===t.currentIndex);i&&(i.style.opacity=t.currentIndex===t.totalItems-1?"0.5":"1",i.disabled=t.currentIndex===t.totalItems-1)}(n)}function r(e,n){const t=n.showQuotes?`"${e.review_content}"`:e.review_content,r=n.showRelativeDate?function(e){const n=new Date(e),t=new Date,r=Math.abs(t-n),o=Math.ceil(r/864e5);return 1===o?"1 day ago":o<7?`${o} days ago`:o<30?`${Math.floor(o/7)} weeks ago`:o<365?`${Math.floor(o/30)} months ago`:`${Math.floor(o/365)} years ago`}(e.created_at):new Date(e.created_at).toLocaleDateString(),o=e.star_rating?function(e,n){const t=n.accentColor||"#4f46e5",r="#cccccc";let o="";for(let n=1;n<=5;n++)o+=n<=e?`<span style="color: ${t};">&#9733;</span>`:n-.5<=e?`<span style="position: relative; display: inline-block; color: ${r};">\n                            &#9733;\n                            <span style="position: absolute; left: 0; top: 0; width: 50%; overflow: hidden; color: ${t};">\n                                &#9733;\n                            </span>\n                        </span>`:`<span style="color: ${r};">&#9733;</span>`;return`<div class="pr-single-stars-row" style="display: flex; justify-content: center; margin-bottom: 1rem;">${o}</div>`}(e.star_rating,n):"";return`\n      <div class="pr-single-review-card" style="\n        background-color: ${n.bgColor||"#ffffff"};\n        border: ${n.borderWidth||2}px solid ${n.borderColor||"#cccccc"};\n        border-radius: ${n.borderRadius||16}px;\n        opacity: ${void 0!==n.bgOpacity?n.bgOpacity:1};\n        color: ${n.textColor||"#22223b"};\n        font-family: ${n.font||"Inter"}, sans-serif;\n        line-height: ${n.lineSpacing||1.4};\n        box-shadow: ${n.shadow?`0 4px 6px -1px rgba(0, 0, 0, ${n.shadowIntensity||.2})`:"none"};\n      ">\n        <div class="pr-single-review-content">\n          ${o}\n          <p class="pr-single-review-text" style="margin-bottom: 1rem;">${t}</p>\n        </div>\n        <div class="pr-single-reviewer-details">\n          <div style="\n            color: ${n.nameTextColor||"#1a237e"};\n            font-weight: 600;\n            margin-bottom: 0.25rem;\n          ">${e.first_name||""} ${e.last_name||""}</div>\n          ${e.reviewer_role?`<div style="\n            color: ${n.roleTextColor||"#6b7280"};\n            font-size: ${n.attributionFontSize||15}px;\n          ">${e.reviewer_role}</div>`:""}\n          <div style="\n            color: ${n.roleTextColor||"#6b7280"};\n            font-size: ${n.attributionFontSize||15}px;\n            margin-top: 0.25rem;\n          ">${r}</div>\n        </div>\n      </div>\n    `}function o(n,t,o,i){!function(n,t,r){e[n]={currentIndex:0,totalItems:t.length,itemsPerView:1,autoAdvance:r.autoAdvance||!1,slideshowSpeed:r.slideshowSpeed||4,autoAdvanceInterval:null}}(n,t,o);const s=e[n],a=t.map(e=>`<div class="pr-single-carousel-item">${r(e,o)}</div>`).join(""),l=o.bgColor||"#ffffff",c=o.borderColor||"#cccccc",d=o.borderWidth||2,p=void 0!==o.bgOpacity?o.bgOpacity:1,g=o.accentColor||"#4f46e5",u=`\n      background-color: ${l};\n      border: ${d}px solid ${c};\n      opacity: ${p};\n    `,v=`\n      background-color: ${l};\n      border: ${d}px solid ${c};\n      border-radius: ${o.buttonBorderRadius||8}px;\n      opacity: ${p};\n      color: ${g};\n    `;return`\n      ${`\n      <style>\n        /* Arrow Color */\n        .pr-single-prev-btn::before { border-color: transparent ${g} transparent transparent !important; }\n        .pr-single-next-btn::before { border-color: transparent transparent transparent ${g} !important; }\n        \n        /* Arrow & Submit Button Hover: Invert colors */\n        .pr-single-prev-btn:hover, .pr-single-next-btn:hover, .pr-single-submit-btn:hover {\n          background-color: ${g} !important;\n          color: ${l} !important;\n        }\n        \n        /* Arrow Icon Hover: Change to background color */\n        .pr-single-prev-btn:hover::before { border-color: transparent ${l} transparent transparent !important; }\n        .pr-single-next-btn:hover::before { border-color: transparent transparent transparent ${l} !important; }\n\n        /* Card Hover: Lift effect */\n        .pr-single-review-card {\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n        .pr-single-review-card:hover {\n          transform: ${o.liftOnHover?"translateY(-5px)":"none"};\n          box-shadow: ${o.liftOnHover?`0 10px 15px -3px rgba(0, 0, 0, ${o.shadowIntensity||.2})`:o.shadow?`0 4px 6px -1px rgba(0, 0, 0, ${o.shadowIntensity||.2})`:"none"};\n        }\n      </style>\n    `}\n      <div class="pr-single-carousel-container">\n        <div class="pr-single-carousel-track">\n          ${a}\n        </div>\n      </div>\n      ${s.totalItems>1?`\n      <div class="pr-single-carousel-controls">\n        <button class="pr-single-prev-btn" style="${u}" title="Previous review"></button>\n        <div class="pr-single-dots-container"></div>\n        <button class="pr-single-next-btn" style="${u}" title="Next review"></button>\n      </div>\n    `:""}\n      ${o.showSubmitReviewButton?`\n      <div class="pr-single-submit-review-container">\n        <a href="/r/${i}?source=widget" target="_blank" class="pr-single-submit-btn" style="${v}">\n          Submit a Review\n        </a>\n      </div>\n    `:""}\n    `}async function i(){const e=document.querySelectorAll("[data-prompt-reviews-id], [data-widget-id]");if(0!==e.length)for(const t of e){const e=t.getAttribute("data-prompt-reviews-id")||t.getAttribute("data-widget-id"),r=t.getAttribute("data-business-slug");t.id=`pr-single-widget-container-${e}`;try{const i=await fetch(`http://localhost:3001/api/widgets/${e}`);if(!i.ok)throw new Error(`Failed to fetch widget data: ${i.statusText}`);const{reviews:s,design:a}=await i.json();s&&s.length>0?(t.innerHTML=o(t.id,s,a,r),n(t.id)):t.innerHTML="<p>No reviews to display.</p>"}catch(e){console.error("Error initializing PromptReviews Single widget:",e),t.innerHTML="<p>Error loading reviews.</p>"}}}window.PromptReviewsSingle=window.PromptReviewsSingle||{},window.PromptReviewsSingle.initializeWidget||(window.PromptReviewsSingle.initializeWidget=function(e,t,r,i){if(console.log("üöÄ SingleWidget: Initializing widget",{containerId:e,reviewsCount:t?.length,design:r}),!t||0===t.length)return void console.warn("‚ö†Ô∏è SingleWidget: No reviews provided");const s=document.getElementById(e);if(!s)return void console.error("‚ùå SingleWidget: Widget container not found:",e);const a=o(e,t,r,i);s.innerHTML=a,n(e,t,r),console.log("‚úÖ SingleWidget: Widget initialized successfully")}),window.PromptReviewsSingle.renderSingleWidget=function(e,n,t,r){window.PromptReviewsSingle.initializeWidget(e,n,t,r)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i(),console.log("‚úÖ SingleWidget: Widget script loaded successfully")}();