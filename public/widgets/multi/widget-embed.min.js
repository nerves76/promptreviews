console.log("üîÑ Multi Widget Script Loading...",(new Date).toISOString()),window.PromptReviews&&window.PromptReviews.renderMultiWidget||function(){function e(){if(document.getElementById("swiper-css"))return;const e=document.createElement("style");e.id="swiper-css",e.textContent="\n        .swiper-button-next,\n        .swiper-button-prev {\n          position: absolute;\n          top: 50%;\n          width: 27px;\n          height: 44px;\n          margin-top: calc(0px - (44px / 2));\n          z-index: 10;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          color: var(--swiper-navigation-color, var(--swiper-theme-color));\n        }\n        .swiper-button-next.swiper-button-disabled,\n        .swiper-button-prev.swiper-button-disabled {\n          opacity: 0.35;\n          cursor: auto;\n          pointer-events: none;\n        }\n        .swiper-button-next:after,\n        .swiper-button-prev:after {\n          font-family: swiper-icons;\n          font-size: 44px;\n          text-transform: none !important;\n          letter-spacing: 0;\n          text-transform: none;\n          font-variant: initial;\n          line-height: 1;\n        }\n        .swiper-button-prev,\n        .swiper-rtl .swiper-button-next {\n          left: 10px;\n          right: auto;\n        }\n        .swiper-button-prev:after,\n        .swiper-rtl .swiper-button-next:after {\n          content: 'prev';\n        }\n        .swiper-button-next,\n        .swiper-rtl .swiper-button-prev {\n          right: 10px;\n          left: auto;\n        }\n        .swiper-button-next:after,\n        .swiper-rtl .swiper-button-prev:after {\n          content: 'next';\n        }\n        .swiper-button-lock {\n          display: none;\n        }\n        .swiper-pagination {\n          position: relative;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          margin-top: 16px;\n        }\n        .swiper-pagination.swiper-pagination-hidden {\n          opacity: 0;\n        }\n        .swiper-pagination-disabled > .swiper-pagination,\n        .swiper-pagination.swiper-pagination-disabled {\n          display: none !important;\n        }\n        .swiper-pagination-bullet {\n          width: 8px !important;\n          height: 8px !important;\n          background: #ccc;\n          opacity: 1;\n          margin: 0 4px;\n          transition: all 0.2s ease;\n          border-radius: 50%;\n          display: inline-block;\n        }\n        .swiper-pagination-bullet-active {\n          transform: scale(1.2);\n          background: var(--swiper-pagination-color, var(--swiper-theme-color));\n        }\n        .swiper-button-disabled {\n          opacity: 0.5;\n          cursor: not-allowed;\n        }\n        \n        /* Responsive classes for embedded widget */\n        .hidden { display: none !important; }\n        .block { display: block !important; }\n        .flex { display: flex !important; }\n        .flex-col { flex-direction: column !important; }\n        .items-center { align-items: center !important; }\n        .justify-center { justify-content: center !important; }\n        .justify-end { justify-content: flex-end !important; }\n        .w-full { width: 100% !important; }\n        .max-w-5xl { max-width: 64rem !important; }\n        .max-w-\\[400px\\] { max-width: 400px !important; }\n        .mx-auto { margin-left: auto !important; margin-right: auto !important; }\n        .px-4 { padding-left: 1rem !important; padding-right: 1rem !important; }\n        .px-8 { padding-left: 2rem !important; padding-right: 2rem !important; }\n        .mt-4 { margin-top: 1rem !important; }\n        .pr-8 { padding-right: 2rem !important; }\n        .relative { position: relative !important; }\n        .absolute { position: absolute !important; }\n        .top-1\\/2 { top: 50% !important; }\n        .-translate-y-1\\/2 { transform: translateY(-50%) !important; }\n        .-left-8 { left: -2rem !important; }\n        .-right-8 { right: -2rem !important; }\n        .left-0 { left: 0 !important; }\n        .right-0 { right: 0 !important; }\n        .z-10 { z-index: 10 !important; }\n        .rounded-full { border-radius: 9999px !important; }\n        .w-10 { width: 2.5rem !important; }\n        .h-10 { height: 2.5rem !important; }\n        .min-w-10 { min-width: 2.5rem !important; }\n        .min-h-10 { min-height: 2.5rem !important; }\n        .border { border-width: 1px !important; }\n        .border-gray-200 { border-color: #e5e7eb !important; }\n        .transition { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter !important; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1) !important; transition-duration: 150ms !important; }\n        .hover\\:bg-opacity-80:hover { --tw-bg-opacity: 0.8 !important; }\n        .md\\:block { display: none; }\n        .md\\:hidden { display: block; }\n        \n        @media (min-width: 768px) {\n          .md\\:block { display: block !important; }\n          .md\\:hidden { display: none !important; }\n        }\n        .group:focus .group-focus\\:fill-white { fill: white !important; }\n        .overflow-hidden { overflow: hidden !important; }\n        \n        .md\\:block { display: none; }\n        .md\\:flex { display: none; }\n      ",document.head.appendChild(e)}function t(){if(!document.querySelector('link[href*="fonts.googleapis.com"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap",document.head.appendChild(e),console.log("Google Fonts (Inter) added to page")}}function n(){return new Promise(((n,o)=>{if("undefined"!=typeof Swiper)return console.log("Swiper already loaded"),void n();if(document.querySelector('script[src*="swiper"]'))return console.log("Swiper script already loading, waiting..."),void function(n,o=10){e(),t();let i=0;const r=()=>{"undefined"!=typeof Swiper?(console.log("Swiper is available"),n()):i<o?(i++,console.log(`Waiting for Swiper... Attempt ${i}`),setTimeout(r,100)):(console.error("Swiper failed to load after maximum attempts"),n())};r()}(n,20);console.log("Loading Swiper script...");const i=document.createElement("script");i.src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js",i.async=!0,i.onload=()=>{console.log("Swiper script loaded successfully"),n()},i.onerror=()=>{console.error("Failed to load Swiper script"),o(new Error("Failed to load Swiper"))},document.head.appendChild(i)}))}function o(){const e="pr-multi-widget-css";if(document.getElementById(e))return;const t=function(){const e=document.getElementsByTagName("script");for(let t=0;t<e.length;t++)if(e[t].src&&e[t].src.includes("widget-embed.js"))return e[t].src;return null}();if(!t)return void console.error("PromptReviews Widget: Could not determine script URL to load styles.");const n=`?v=${(new Date).getTime()}`,o=t.replace("widget-embed.js","multi-widget.css")+n;console.log("PromptReviews Widget: Attempting to load CSS from:",o);const i=document.createElement("link");i.id=e,i.rel="stylesheet",i.type="text/css",i.href=o,i.onload=()=>{console.log("PromptReviews Widget: CSS loaded successfully.")},i.onerror=()=>{console.error("PromptReviews Widget: FAILED to load CSS.")},document.head.appendChild(i)}function i(e,t=1){3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map((e=>e+e)).join(""));const n=parseInt(e,16);return`rgba(${n>>16&255},${n>>8&255},${255&n},${t})`}function r(e,t,n){const o=e.map((e=>({content:e.content||e.review_content||"",name:e.name||e.reviewer_name||(e.first_name||"")+(e.last_name?" "+e.last_name:"")||"Anonymous",role:e.role||e.reviewer_role||"",rating:e.rating||e.star_rating||5,date:e.date||e.created_at||(new Date).toISOString()}))).map((e=>`\n        <div class="swiper-slide" style="padding-left: 0.75rem; padding-right: 0.75rem;">\n          <div class="pr-review-card">\n            <div class="stars-row">${function(e){("number"!=typeof e||e<0||e>5)&&(e=5);const t=Math.floor(e),n=e%1!=0,o=5-t-(n?1:0);return`<span class="stars" style="color: gold;">${"‚òÖ".repeat(t)+(n?"¬Ω":"")+"‚òÜ".repeat(o)}</span>`}(e.rating)}</div>\n            <div class="review-content">\n              ${t.showQuotes?'<div class="decorative-quote decorative-quote-open">‚Äú</div>':""}\n              <div class="review-text">${e.content}</div>\n              ${t.showQuotes?'<div class="decorative-quote decorative-quote-close">‚Äù</div>':""}\n            </div>\n            <div class="reviewer-details">\n              <div class="reviewer-name">${e.name}</div>\n              ${e.role?`<div class="reviewer-role">${e.role}</div>`:""}\n              ${t.showRelativeDate&&e.date?`<div class="reviewer-date">${function(e){const t=new Date,n=new Date(e),o=t.getTime()-n.getTime(),i=Math.floor(o/1e3),r=Math.floor(i/60),s=Math.floor(r/60),a=Math.floor(s/24),l=Math.floor(a/7),d=Math.floor(a/30),p=Math.floor(a/365);return p>0?`${p} year${p>1?"s":""} ago`:d>0?`${d} month${d>1?"s":""} ago`:l>0?`${l} week${l>1?"s":""} ago`:a>0?`${a} day${a>1?"s":""} ago`:s>0?`${s} hour${s>1?"s":""} ago`:r>0?`${r} minute${r>1?"s":""} ago`:"just now"}(e.date)}</div>`:""}\n            </div>\n          </div>\n        </div>\n      `)).join("");return`\n        <div class="pr-multi-widget">\n          \x3c!-- Desktop/Tablet view --\x3e\n          <div class="widget-desktop">\n            <div class="widget-content">\n              <div class="widget-outer-container">\n                <div class="widget-carousel-container">\n                  <div class="swiper swiper-desktop">\n                    <div class="swiper-wrapper">${o}</div>\n                  </div>\n                  <div class="swiper-button-prev">‚Äπ</div>\n                  <div class="swiper-button-next">‚Ä∫</div>\n                </div>\n                <div class="swiper-pagination"></div>\n              </div>\n            </div>\n          </div>\n\n          \x3c!-- Mobile view --\x3e\n          <div class="widget-mobile">\n             <div class="swiper swiper-mobile">\n               <div class="swiper-wrapper">${o}</div>\n             </div>\n             <div class="mobile-nav-row">\n               <div class="swiper-button-prev">‚Äπ</div>\n               <div class="swiper-pagination"></div>\n               <div class="swiper-button-next">‚Ä∫</div>\n             </div>\n          </div>\n\n          \x3c!-- Submit Button (outside main content) --\x3e\n          ${!1!==t.showSubmitReviewButton&&n?`\n        <div class="submit-review-button-container">\n            <a href="/r/${n}" target="_blank" class="submit-review-button">\n                <span class="relative z-10">Submit a Review</span>\n            </a>\n        </div>\n      `:""}\n        </div>\n      `}function s(s,a){o(),e(),t(),console.log("üéØ renderMultiWidget called. Full data from API:",a),n().then((()=>{s.innerHTML="";const{reviews:e=[],design:t={},businessSlug:n}=a;console.log("%cUser design from data:","color: green; font-weight: bold;",t);const o={bgColor:"#ffffff",textColor:"#22223b",accentColor:"#6a5acd",bodyTextColor:"#22223b",nameTextColor:"#1a237e",roleTextColor:"#6b7280",borderColor:"#cccccc",font:"Inter",showSubmitReviewButton:!0,...t};if(console.log("%cFinal merged design:","color: purple; font-weight: bold;",o),!e||0===e.length)return void(s.innerHTML='<div class="text-center text-gray-400 py-8">No reviews available</div>');const l=r(e,o,n);s.innerHTML=l,setTimeout((()=>{!function(e,t){const n=e.querySelector(".pr-multi-widget");if(n&&t){console.log("%cApplying design settings:","color: blue; font-weight: bold;",t);const e=t;if(n.style.setProperty("--pr-accent-color",e.accentColor||"#6a5acd"),n.style.setProperty("--pr-bg-color",e.bgColor||"#ffffff"),n.style.setProperty("--pr-text-primary",e.textColor||"#22223b"),n.style.setProperty("--pr-name-text-color",e.nameTextColor||"#1a237e"),n.style.setProperty("--pr-role-text-color",e.roleTextColor||"#6b7280"),n.style.setProperty("--pr-border-width",`${e.borderWidth||2}px`),n.style.setProperty("--pr-border-color",e.borderColor||"#cccccc"),n.style.setProperty("--pr-border-radius",`${e.borderRadius||16}px`),n.style.setProperty("--pr-attribution-font-size",`${e.attributionFontSize||15}px`),n.style.setProperty("--pr-line-spacing",e.lineSpacing||1.4),n.style.setProperty("--pr-shadow-intensity",e.shadowIntensity||.2),n.style.setProperty("--pr-shadow-color-raw",e.shadowColor||"#222222"),n.style.setProperty("--pr-font",e.font||"Inter"),!1!==e.border){const t=e.borderWidth||2,o=e.borderColor||"#cccccc";n.style.setProperty("--pr-card-border",`${t}px solid ${o}`),n.style.setProperty("--pr-button-border",`${t}px solid ${o}`)}else n.style.setProperty("--pr-card-border","none"),n.style.setProperty("--pr-button-border","none");if(!1!==e.shadow){const t=e.shadowColor||"#222222",o=e.shadowIntensity||.2,r=i(t,o);n.style.setProperty("--pr-card-shadow",`0 4px 32px ${r} inset`);const s=i(t,.75*o);n.style.setProperty("--pr-button-shadow",`0 1px 4px ${s} inset`)}else n.style.setProperty("--pr-card-shadow","none"),n.style.setProperty("--pr-button-shadow","none");if("custom"===e.sectionBgType&&e.sectionBgColor){const t=n.parentElement;t&&(t.style.backgroundColor=e.sectionBgColor,t.style.padding="2rem 0")}}const o=e.querySelector(".swiper-desktop");o&&new Swiper(o,{slidesPerView:1,spaceBetween:0,observer:!0,observeParents:!0,navigation:{nextEl:".widget-desktop .swiper-button-next",prevEl:".widget-desktop .swiper-button-prev"},pagination:{el:".widget-desktop .swiper-pagination",clickable:!0},breakpoints:{768:{slidesPerView:2,spaceBetween:0},1280:{slidesPerView:3,spaceBetween:0}}});const r=e.querySelector(".swiper-mobile");r&&new Swiper(r,{slidesPerView:1,spaceBetween:0,centeredSlides:!0,observer:!0,observeParents:!0,pagination:{el:".widget-mobile .swiper-pagination",clickable:!0},navigation:{nextEl:".widget-mobile .swiper-button-next",prevEl:".widget-mobile .swiper-button-prev"},breakpoints:{768:{slidesPerView:2,spaceBetween:0},1280:{slidesPerView:3,spaceBetween:0}}})}(s,o),setTimeout((()=>{const e=s.querySelector(".swiper")?.swiper;e&&(e.update(),e.updateSize(),e.updateSlides(),console.log("Swiper updated after content render"))}),200)}),100)})).catch((e=>{console.error("Failed to load Swiper:",e),s.innerHTML=`\n          <div class="text-center text-gray-400 py-8">\n            <p>Widget loading failed</p>\n            <p class="text-sm">${e.message}</p>\n                    </div>\n                `}))}async function a(){console.log("üîç loadMultiWidgets called - searching for widgets...");const e=document.querySelectorAll('.promptreviews-widget[data-widget-type="multi"]');console.log("Found widgets:",e.length,e);for(const t of e){const e=t.getAttribute("data-widget");if(console.log("Processing widget with ID:",e),e)try{console.log("Fetching data for widget:",e);const n=await fetch(`/api/widgets/${e}`);if(!n.ok)throw new Error("Failed to load widget data");const o=await n.json();console.log("Widget data received:",o),s(t,o)}catch(e){console.error("Error loading widget:",e),t.innerHTML='<div class="error">Failed to load widget</div>'}else console.log("No widget ID found, skipping...")}}console.log("IIFE starting..."),window.PromptReviews=window.PromptReviews||{},document.addEventListener("DOMContentLoaded",(()=>{console.log("üìÖ DOMContentLoaded event fired"),a()})),window.addEventListener("load",(()=>{console.log("üåê Window load event fired"),document.querySelector('.promptreviews-widget[data-widget-type="multi"] .widget-content')||a()})),window.PromptReviews.renderMultiWidget=s,window.initializePromptReviewsWidget=async function(e){return console.log("initializePromptReviewsWidget called with widgetId:",e),Promise.resolve()},console.log("Widget script loaded successfully")}();