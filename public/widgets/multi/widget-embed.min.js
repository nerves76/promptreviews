!function(){"use strict";function e(e,n){const t=n.bgColor||"#ffffff";let r=n.textColor||"#22223b";(function(e){if(!e||e.length<4)return!1;let n="#"===e.charAt(0)?e.substring(1):e;3===n.length&&(n=n.split("").map(e=>e+e).join(""));const t=parseInt(n.substring(0,2),16),r=parseInt(n.substring(2,4),16),o=parseInt(n.substring(4,6),16);return Math.sqrt(t*t*.299+r*r*.587+o*o*.114)<127.5})(t)&&(r="#ffffff");const o=n.nameTextColor||r,i=n.nameTextColor||r,s=n.accentColor||"#4f46e5",a=n.borderRadius||16,d=n.borderWidth||2,l=n.borderColor||"#cccccc",c=void 0!==n.bgOpacity?n.bgOpacity:1,p=n.font||"Inter",u=n.quoteSize||1.5;let g=`\n      background-color: ${t};\n      color: ${r};\n      border-radius: ${a}px;\n      padding: 1.25rem;\n      display: flex;\n      flex-direction: column;\n      font-family: ${p}, sans-serif;\n      opacity: ${c};\n    `;if(!0===n.border?g+=`border: ${d}px solid ${l};`:g+="border: none;",n.shadow){n.shadowColor;g+=`box-shadow: inset 0 0 20px rgba(0, 0, 0, ${n.shadowIntensity||.2});`}const m=n.showQuotes?`<span class="decorative-quote-opening" style="color: ${s}; font-size: ${u}rem; font-weight: bold; line-height: 1; opacity: 0.3; margin-bottom: 0.5rem; display: block; text-align: left; width: 100%;">&#8220;</span>`:"",f=n.showQuotes?`<span class="decorative-quote-closing" style="color: ${s}; font-size: ${u}rem; font-weight: bold; line-height: 1; opacity: 0.3; position: absolute; bottom: 1rem; right: 1rem;">&#8221;</span>`:"",h=e.star_rating?`<div class="stars-row" style="margin-bottom: 0.75rem; display: flex; justify-content: center;">${function(e){let n="";for(let t=1;t<=5;t++)n+=`<span class="star${t<=e?" filled":""}" style="color: ${t<=e?"#ffc107":"#e0e0e0"}; font-size: 1.2rem;">&#9733;</span>`;return n}(e.star_rating)}</div>`:"",w=n.showRelativeDate&&e.created_at?`<div class="reviewer-date" style="font-size: 0.875rem; color: ${i}; opacity: 0.65; margin-top: 0.5rem;">${function(e){const n=new Date(e),t=new Date,r=Math.round((t-n)/1e3),o=Math.round(r/60),i=Math.round(o/60),s=Math.round(i/24),a=Math.round(s/7),d=Math.round(s/30.44),l=Math.round(s/365.25);return r<60?`${r} second${1!==r?"s":""} ago`:o<60?`${o} minute${1!==o?"s":""} ago`:i<24?`${i} hour${1!==i?"s":""} ago`:s<7?`${s} day${1!==s?"s":""} ago`:a<5?`${a} week${1!==a?"s":""} ago`:d<12?`${d} month${1!==d?"s":""} ago`:`${l} year${1!==l?"s":""} ago`}(e.created_at)}</div>`:"";return`\n      <div class="pr-review-card" style="${g}">\n        ${h}\n        <div class="review-content" style="flex-grow: 1; position: relative;">\n          ${m}\n          <p class="review-text" style="margin: 0; font-size: 0.9rem; line-height: 1.4; color: ${r}; padding-left: ${n.showQuotes?"0.75rem":"0"}; padding-right: ${n.showQuotes?"1.5rem":"0"}; padding-bottom: ${n.showQuotes?"1.5rem":"0"};">${e.review_content}</p>\n          ${f}\n        </div>\n        <div class="reviewer-details" style="margin-top: 0.75rem; text-align: center;">\n          <div class="reviewer-name" style="font-weight: bold; font-size: 0.9rem; color: ${o};">${e.first_name||""} ${e.last_name||""}</div>\n          ${e.reviewer_role?`<div class="reviewer-role" style="font-size: 0.8rem; color: ${i}; opacity: 0.65;">${e.reviewer_role}</div>`:""}\n          ${w}\n        </div>\n      </div>\n    `}let n={};function t(e){const t=n[e];if(!t)return;const o=document.getElementById(e);if(!o)return;const i=o.querySelector(".pr-carousel-track");if(!i)return;t.itemsPerView=function(e){const n=document.getElementById(e);if(!n)return 3;const t=n.querySelector(".pr-carousel-container"),r=n.querySelector(".pr-carousel-item");if(!t||!r||0===r.offsetWidth)return window.innerWidth<=640?1:window.innerWidth<=1024?2:3;const o=getComputedStyle(r.parentElement).gap,i=parseFloat(o)||16,s=t.offsetWidth,a=r.offsetWidth,d=Math.round((s+i)/(a+i));return Math.max(1,d)}(e);const s=o.querySelector(".pr-carousel-item");if(!s)return;const a=window.getComputedStyle(i).gap,d=parseFloat(a)||16,l=s.offsetWidth+d,c=-t.currentIndex*l;i.style.transform=`translateX(${c}px)`,function(e){const t=n[e],o=document.getElementById(e);if(!t||!o)return;const i=o.querySelector(".pr-dots-container");if(!i)return;const s=Math.ceil(t.reviews.length/t.itemsPerView);if(i.children.length!==s){let t="";for(let e=0;e<s;e++)t+=`<button class="pr-dot" data-index="${e}"></button>`;i.innerHTML=t,i.querySelectorAll(".pr-dot").forEach(t=>{t.addEventListener("click",t=>{const o=n[e];if(!o)return;const i=parseInt(t.target.dataset.index,10)*o.itemsPerView;r(e,i)})})}const a=i.querySelectorAll(".pr-dot"),d=t.currentIndex;a.forEach((e,n)=>{e.classList.toggle("active",n===d),e.style.backgroundColor=n===d?t.design.accentColor||"#4f46e5":"#cccccc"})}(e),function(e){const t=n[e],r=document.getElementById(e);if(!t||!r)return;const o=r.querySelector(".pr-prev-btn"),i=r.querySelector(".pr-next-btn");if(!o||!i)return;const s=Math.max(0,t.reviews.length-t.itemsPerView);o.disabled=0===t.currentIndex,i.disabled=t.currentIndex>=s}(e)}function r(e,r){const o=n[e];if(!o)return;const i=Math.max(0,o.reviews.length-o.itemsPerView),s=Math.max(0,Math.min(r,i));s!==o.currentIndex&&(o.currentIndex=s,t(e))}function o(t,r,o,i){!function(e,t,r){n[e]={currentIndex:0,itemsPerView:3,reviews:t,design:r,autoAdvance:r.autoAdvance||!1,slideshowSpeed:r.slideshowSpeed||4,autoAdvanceInterval:null,get totalPages(){return Math.ceil(this.reviews.length/this.itemsPerView)}}}(t,r,o);n[t];if(!r||0===r.length)return'\n        <div class="pr-multi-widget">\n          <div style="display: flex; align-items: center; justify-content: center; min-height: 200px; color: white; font-size: 18px;">\n            <div style="text-align: center;">\n              <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">\n                <svg style="width: 24px; height: 24px;" fill="currentColor" viewBox="0 0 20 20">\n                  <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd" />\n                </svg>\n                <span>Add reviews to your widget</span>\n              </div>\n              <p style="font-size: 14px; opacity: 0.8;">Click the speech bubble icon above to add and manage reviews.</p>\n            </div>\n          </div>\n        </div>\n      ';const s=r.map(n=>`<div class="pr-carousel-item">${e(n,o)}</div>`).join(""),a=o.bgColor||"#ffffff",d=o.borderColor||"#cccccc",l=o.borderWidth||2,c=void 0!==o.bgOpacity?o.bgOpacity:1,p=o.accentColor||"#4f46e5",u=`\n      background-color: ${a};\n      ${o.border?`border: ${l}px solid ${d};`:"border: none;"}\n      opacity: ${c};\n    `;return`\n      <div class="pr-multi-widget">\n        <style>\n          ${`\n      .pr-prev-btn::before {\n        border-color: transparent ${p} transparent transparent !important;\n      }\n      .pr-next-btn::before {\n        border-color: transparent transparent transparent ${p} !important;\n      }\n      \n      /* Hover effects for arrow buttons - invert colors */\n      .pr-prev-btn:hover,\n      .pr-next-btn:hover {\n        background-color: ${p} !important;\n        border-color: ${p} !important;\n      }\n      \n      .pr-prev-btn:hover::before {\n        border-color: transparent ${a} transparent transparent !important;\n      }\n      \n      .pr-next-btn:hover::before {\n        border-color: transparent transparent transparent ${a} !important;\n      }\n      \n      /* Hover effect for submit button - invert colors */\n      .pr-submit-btn:hover {\n        background-color: ${p} !important;\n        color: ${a} !important;\n      }\n      \n      /* Hover effect for review cards - lift up */\n      .pr-review-card {\n        transition: transform 0.2s ease, box-shadow 0.2s ease;\n      }\n      \n      .pr-review-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);\n      }\n    `}\n        </style>\n        <div class="pr-carousel-container">\n          <div class="pr-carousel-track">\n            ${s}\n          </div>\n        </div>\n        <div class="pr-carousel-controls">\n          <button class="pr-prev-btn" style="${u}"></button>\n          <div class="pr-dots-container"></div>\n          <button class="pr-next-btn" style="${u}"></button>\n        </div>\n        ${o.showSubmitReviewButton?`\n      <div class="pr-submit-review-container">\n        <a href="https://prompt.reviews/r/${i}" target="_blank" rel="noopener noreferrer" class="pr-submit-btn"\n           style="\n             background-color: ${a};\n             ${o.border?`border: ${l}px solid ${d};`:"border: none;"}\n             opacity: ${c};\n             color: ${p};\n             padding: 8px 16px;\n             text-decoration: none;\n             font-weight: 500;\n             border-radius: 8px;\n             display: inline-block;\n           ">\n          Submit a Review\n        </a>\n      </div>\n    `:""}\n      </div>\n    `}function i(e){const o=document.getElementById(e);if(!o)return;const i=n[e];if(!i)return;const s=o.querySelector(".pr-prev-btn"),a=o.querySelector(".pr-next-btn");s&&a?(s.addEventListener("click",()=>{const t=n[e];r(e,t.currentIndex-1)}),a.addEventListener("click",()=>{const t=n[e];r(e,t.currentIndex+1)}),i.autoAdvance&&i.reviews.length>i.itemsPerView&&(i.autoAdvanceInterval=setInterval(()=>{const n=Math.max(0,i.reviews.length-i.itemsPerView);i.currentIndex>=n?i.currentIndex=0:i.currentIndex++,t(e)},1e3*i.slideshowSpeed)),t(e),window.addEventListener("resize",()=>t(e))):console.log("üîç Widget: Navigation buttons not found (likely no reviews to display)")}async function s(){if(window.location.pathname.includes("/dashboard"))return void console.log("üîÑ MultiWidget: Dashboard context detected, skipping auto-initialization");const e=document.querySelectorAll("[data-prompt-reviews-id], [data-widget-id]");if(0!==e.length){(()=>{if(document.getElementById("promptreviews-widget-styles"))return;const e=document.createElement("style");e.id="promptreviews-widget-styles",e.textContent='\n      /* \n        Canonical CSS for the Multi-Widget.\n        This file is the single source of truth for styling the multi-widget,\n        used by both the dashboard preview and the live embeddable widget.\n      */\n\n      /* \n        Container styles to mimic the dashboard preview environment.\n        This ensures the embedded widget has a consistent, centered,\n        and responsive container, just like in the app.\n      */\n      #promptreviews-widget,\n      #promptreviews-multi-widget,\n      #promptreviews-single-widget,\n      #promptreviews-photo-widget {\n          position: relative;\n          width: 100%;\n          max-width: 64rem; /* 1024px */\n          margin-left: auto;\n          margin-right: auto;\n          font-size: 16px; /* Set a consistent base font size for rem calculations */\n        }\n        \n        /* Base widget styling reset */\n        .pr-multi-widget {\n          all: revert;\n          box-sizing: border-box;\n          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n          padding: 0 1rem; /* Add horizontal padding here */\n        }\n        \n        /* Carousel Layout */\n        .pr-carousel-container {\n            position: relative;\n            overflow: hidden;\n            width: 100%;\n            /* Padding removed from here */\n        }\n        \n        .pr-carousel-track {\n            display: flex;\n            transition: transform 0.5s ease;\n            gap: 1rem;\n        }\n        \n        /* This is a key part of the fix: making the item a flex container */\n        .pr-carousel-item {\n            flex-shrink: 0;\n            width: calc(100% / 3 - 1rem * 2 / 3);\n            display: flex; \n        }\n        \n        /* Review Card Styles */\n        .pr-multi-widget .pr-review-card {\n            background: var(--pr-card-bg, #fff);\n            border: var(--pr-card-border, 2px solid #cccccc);\n            border-radius: var(--pr-card-radius, 16px);\n            padding: 1.5rem;\n            display: flex;\n            flex-direction: column;\n            width: 100%;\n            text-align: center;\n            /* This is the other key part: making the card grow */\n            flex-grow: 1; \n        }\n        \n        .pr-multi-widget .review-content {\n            flex-grow: 1; /* Ensures the text content area grows, pushing footer down */\n        }\n        \n        .pr-multi-widget .reviewer-details {\n            margin-top: auto; /* Pushes details to the bottom of the card */\n        }\n        \n        /* --- Other existing styles below --- */\n        \n        .pr-multi-widget .stars-row {\n            display: flex;\n            justify-content: center;\n        }\n        \n        .pr-multi-widget .review-text {\n            margin: 0;\n        }\n        \n        .pr-carousel-controls {\n            text-align: center;\n            margin-top: 1.5rem;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 10px;\n        }\n        \n        .pr-prev-btn,\n        .pr-next-btn {\n            cursor: pointer;\n            width: 40px;\n            height: 40px;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            transition: all 0.2s ease;\n            position: relative;\n        }\n        \n        .pr-prev-btn::before,\n        .pr-next-btn::before {\n            content: \'\';\n            width: 0;\n            height: 0;\n            border-style: solid;\n        }\n        \n        .pr-prev-btn::before {\n            border-width: 6px 8px 6px 0;\n            border-color: transparent #4f46e5 transparent transparent;\n            margin-left: -2px;\n        }\n        \n        .pr-next-btn::before {\n            border-width: 6px 0 6px 8px;\n            border-color: transparent transparent transparent #4f46e5;\n            margin-right: -2px;\n        }\n        \n        .pr-dots-container {\n            display: flex;\n            gap: 16px;\n            align-items: center;\n        }\n        \n        .pr-dot {\n            height: 12px;\n            width: 12px;\n            border: none;\n            border-radius: 50%;\n            cursor: pointer;\n            padding: 0;\n            margin: 0;\n        }\n        \n        .pr-submit-review-container {\n            text-align: right;\n            margin-top: 0.5rem;\n        }\n        \n        .pr-submit-btn {\n            display: inline-block;\n            padding: 8px 16px;\n            text-decoration: none;\n            font-weight: 500;\n        }\n        \n        /* Responsive Design */\n        @media (max-width: 1024px) {\n            .pr-carousel-item {\n                width: calc(100% / 2 - 1rem * 1 / 2); /* Two cards */\n            }\n        }\n        \n        @media (max-width: 640px) {\n            .pr-carousel-item {\n                width: 100%; /* One card */\n                gap: 0;\n            }\n            .pr-carousel-track {\n              gap: 0;\n            }\n        }\n    ',document.head.appendChild(e)})();for(const n of e){const e=n.getAttribute("data-prompt-reviews-id")||n.getAttribute("data-widget-id"),t=n.getAttribute("data-business-slug");n.id=`pr-widget-container-${e}`;try{const r="app.promptreviews.app"===window.location.hostname?`/api/widgets/${e}`:`https://app.promptreviews.app/api/widgets/${e}`,s=await fetch(r);if(!s.ok)throw new Error(`Failed to fetch widget data: ${s.statusText}`);const{reviews:a,design:d}=await s.json();a&&a.length>0?(n.innerHTML=o(n.id,a,d,t),i(n.id)):n.innerHTML='\n        <div style="display: flex; align-items: center; justify-content: center; min-height: 200px; color: white; font-size: 18px;">\n          <div style="text-align: center;">\n            <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">\n              <svg style="width: 24px; height: 24px;" fill="currentColor" viewBox="0 0 20 20">\n                <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd" />\n              </svg>\n              <span>Add reviews to your widget</span>\n            </div>\n            <p style="font-size: 14px; opacity: 0.8;">Click talk bubble icon to add and manage reviews.</p>\n          </div>\n        </div>\n      '}catch(e){console.error("Error initializing PromptReviews widget:",e),n.innerHTML="<p>Error loading reviews.</p>"}}}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s(),window.PromptReviews=window.PromptReviews||{},window.PromptReviews.initializeWidget=function(e,n,t,r){const s=document.getElementById(e);s?(s.setAttribute("data-prompt-reviews-id",e.replace("promptreviews-widget-container-","")),r&&s.setAttribute("data-business-slug",r),s.innerHTML=o(e,n,t,r),i(e)):console.error("Container not found:",e)}}();