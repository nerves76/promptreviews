if(!window.PromptReviews||!window.PromptReviews.renderMultiWidget){(function(){console.log("IIFE starting...");window.PromptReviews=window.PromptReviews||{};function addSwiperCSS(){if(!document.querySelector('link[href*="swiper.min.css"]')){const swiperCSS=document.createElement("link");swiperCSS.rel="stylesheet";swiperCSS.href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css";document.head.appendChild(swiperCSS);console.log("Swiper CSS added to page")}}function loadGoogleFonts(){if(!document.querySelector('link[href*="fonts.googleapis.com"]')){const fontLink=document.createElement("link");fontLink.rel="stylesheet";fontLink.href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap";document.head.appendChild(fontLink);console.log("Google Fonts (Inter) added to page")}}function waitForSwiper(callback,maxAttempts=10){addSwiperCSS();loadGoogleFonts();let attempts=0;const checkSwiper=()=>{if(typeof Swiper!=="undefined"){console.log("Swiper is available");callback()}else if(attempts<maxAttempts){attempts++;console.log(`Waiting for Swiper... Attempt ${attempts}`);setTimeout(checkSwiper,100)}else{console.error("Swiper failed to load after maximum attempts")}};checkSwiper()}function hexToRgba(hex,alpha=1){hex=hex.replace(/^#/,"");if(hex.length===3)hex=hex.split("").map(x=>x+x).join("");const num=parseInt(hex,16);const r=num>>16&255;const g=num>>8&255;const b=num&255;return`rgba(${r},${g},${b},${alpha})`}function lightenHex(hex,amount=.7){hex=hex.replace(/^#/,"");if(hex.length===3)hex=hex.split("").map(x=>x+x).join("");const num=parseInt(hex,16);let r=num>>16&255;let g=num>>8&255;let b=num&255;r=Math.round(r+(255-r)*amount);g=Math.round(g+(255-g)*amount);b=Math.round(b+(255-b)*amount);return`#${((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)}`}function renderStars(rating){if(typeof rating!=="number"||isNaN(rating))return"";let stars="";for(let i=1;i<=5;i++){const full=i<=Math.floor(rating);const half=!full&&i-.5<=rating;const gradientId=`half-star-gradient-${i}-${Math.random()}`;stars+=`<svg width="20" height="20" viewBox="0 0 20 20" fill="${full?"#FBBF24":half?`url(#${gradientId})`:"#E5E7EB"}" stroke="#FBBF24" style="display: inline-block; margin-right: 2px;">${half?`<defs><linearGradient id="${gradientId}"><stop offset="50%" stopColor="#FBBF24" /><stop offset="50%" stopColor="#E5E7EB" /></linearGradient></defs>`:""}<polygon points="10,1 12.59,7.36 19.51,7.64 14,12.14 15.82,18.99 10,15.27 4.18,18.99 6,12.14 0.49,7.64 7.41,7.36" /></svg>`}return`<span class="stars-row">${stars}</span>`}function getRelativeTime(dateString){const now=new Date;const date=new Date(dateString);const diff=now.getTime()-date.getTime();const seconds=Math.floor(diff/1e3);const minutes=Math.floor(seconds/60);const hours=Math.floor(minutes/60);const days=Math.floor(hours/24);const weeks=Math.floor(days/7);const months=Math.floor(days/30);const years=Math.floor(days/365);if(years>0)return`${years} year${years>1?"s":""} ago`;if(months>0)return`${months} month${months>1?"s":""} ago`;if(weeks>0)return`${weeks} week${weeks>1?"s":""} ago`;if(days>0)return`${days} day${days>1?"s":""} ago`;if(hours>0)return`${hours} hour${hours>1?"s":""} ago`;if(minutes>0)return`${minutes} minute${minutes>1?"s":""} ago`;return"just now"}function getInitials(first,last){let f=first?first[0]:"";let l=last?last[0]:"";return(f+l).toUpperCase()}function generateScopedCSS(widgetClass){return`
            /* Base styles */
            .${widgetClass} {
                font-family: var(--pr-font, 'Inter'), -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
                --pr-accent-color: #6a5acd;
                --pr-accent-hover: #4a3f8c;
                --pr-text-primary: #22223b;
                --pr-text-secondary: #6b7280;
                --pr-border-color: #cccccc;
                --pr-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                --pr-card-bg: var(--pr-bg-color, #ffffff);
                --pr-card-border: var(--pr-border-width, 2px) solid var(--pr-border-color, #cccccc);
                --pr-card-radius: var(--pr-border-radius, 16px);
                --pr-card-shadow: 0 4px 32px rgba(34, 34, 34, var(--pr-shadow-intensity, 0.2)) inset;
                width: 100%;
                max-width: 100%;
                margin: 0 auto;
                padding: 1rem;
                box-sizing: border-box;
            }

            /* Widget Content */
            .${widgetClass} .widget-content {
                width: 100%;
                max-width: 1200px;
                margin: 0 auto;
                padding: 1rem;
            }

            /* Carousel Container */
            .${widgetClass} .widget-carousel-container {
                position: relative;
                width: 100%;
                margin: 0 auto;
                padding: 0 2rem;
            }

            /* Swiper Container */
            .${widgetClass} .swiper {
                width: 100%;
                padding: 2rem 0;
                overflow: hidden;
            }

            /* Swiper Slides */
            .${widgetClass} .swiper-slide {
                display: flex;
                justify-content: center;
                align-items: stretch;
                height: auto;
            }

            .${widgetClass} .swiper-slide-active {
                z-index: 1;
            }

            /* Review Cards */
            .${widgetClass} .pr-review-card {
                background: var(--pr-card-bg, #fff);
                border: var(--pr-card-border, 2px solid #cccccc);
                border-radius: var(--pr-card-radius, 16px);
                box-shadow: var(--pr-card-shadow, 0 4px 32px rgba(34,34,34,0.2) inset);
                padding: 2rem;
                height: 100%;
                display: flex;
                flex-direction: column;
                gap: 1rem;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
                width: 100%;
                min-width: 280px;
                max-width: 420px;
                margin: 0 auto;
                box-sizing: border-box;
                text-align: center;
            }

            .${widgetClass} .pr-review-card:hover {
                transform: translateY(-4px);
                box-shadow: 0 8px 32px rgba(34, 34, 34, 0.15);
            }

            /* Stars */
            .${widgetClass} .stars-row {
                display: flex;
                gap: 0.25rem;
                margin-bottom: 0.5rem;
                justify-content: center;
            }

            /* Review Content */
            .${widgetClass} .review-content {
                position: relative;
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                gap: 1rem;
                align-items: center;
            }

            .${widgetClass} .review-text {
                font-size: 1.125rem;
                line-height: 1.75;
                color: var(--pr-text-primary, #22223b);
                margin: 0.5rem 0;
                text-align: center;
            }

            .${widgetClass} .decorative-quote {
                font-size: 3rem;
                line-height: 1;
                color: var(--pr-accent-color, #6a5acd);
                opacity: 0.2;
                font-family: Georgia, serif;
            }

            .${widgetClass} .decorative-quote-open {
                margin-bottom: -1rem;
            }

            .${widgetClass} .decorative-quote-close {
                margin-top: -1rem;
                align-self: flex-end;
            }

            /* Reviewer Details */
            .${widgetClass} .reviewer-details {
                margin-top: auto;
                padding-top: 1rem;
                border-top: 1px solid var(--pr-border-color, #cccccc);
            }

            .${widgetClass} .reviewer-name {
                font-weight: 600;
                color: var(--pr-name-text-color, #111111);
                margin-bottom: 0.25rem;
            }

            .${widgetClass} .reviewer-role {
                font-size: 0.875rem;
                color: var(--pr-role-text-color, #666666);
                margin-bottom: 0.25rem;
            }

            .${widgetClass} .reviewer-date {
                font-size: 0.75rem;
                color: var(--pr-text-secondary, #6b7280);
            }

            /* Submit Review Button */
            .${widgetClass} .submit-review-row {
                display: flex;
                justify-content: flex-end;
                margin-top: 0;
            }

            .${widgetClass} .submit-review-btn {
                background: var(--pr-accent-color, #6a5acd);
                color: #fff;
                padding: 0.75rem 1.5rem;
                border-radius: 0.5rem;
                font-weight: 500;
                transition: all 0.3s ease;
                border: none;
                cursor: pointer;
            }

            .${widgetClass} .submit-review-btn:hover {
                background: var(--pr-accent-hover, #4a3f8c);
                transform: translateY(-2px);
            }

            /* Pagination */
            .${widgetClass} .swiper-pagination {
                position: relative;
                margin-top: 2rem;
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 0.5rem;
            }

            .${widgetClass} .swiper-pagination-bullet {
                width: 8px !important;
                height: 8px !important;
                background: var(--pr-border-color, #d1d5db) !important;
                opacity: 1 !important;
                transition: all 0.3s ease;
                margin: 0 !important;
            }

            .${widgetClass} .swiper-pagination-bullet-active {
                background: var(--pr-accent-color, #6a5acd) !important;
                transform: scale(1.2);
            }

            /* Navigation Controls */
            .${widgetClass} .desktop-nav,
            .${widgetClass} .desktop-pagination {
                display: flex;
            }
            .${widgetClass} .mobile-nav-row {
                display: none;
            }

            /* Navigation arrow styles (desktop) */
            .${widgetClass} .swiper-button-next,
            .${widgetClass} .swiper-button-prev {
                color: var(--pr-accent-color, #6a5acd);
                background: var(--pr-card-bg, #fff);
                width: 2.5rem;
                height: 2.5rem;
                border-radius: 50%;
                box-shadow: var(--pr-shadow, 0 4px 6px rgba(0, 0, 0, 0.1));
                transition: all 0.3s ease;
                position: absolute;
                top: 50%;
                transform: translateY(-50%);
                z-index: 50;
                border: 1px solid var(--pr-border-color, #cccccc);
            }

            .${widgetClass} .swiper-button-next:after,
            .${widgetClass} .swiper-button-prev:after {
                font-size: 1rem;
                font-weight: bold;
            }

            .${widgetClass} .swiper-button-next {
                right: -3rem;
            }

            .${widgetClass} .swiper-button-prev {
                left: -3rem;
            }

            .${widgetClass} .swiper-button-next:hover,
            .${widgetClass} .swiper-button-prev:hover {
                background: var(--pr-accent-color, #6a5acd);
                color: #fff;
            }

            /* Navigation breakpoint at 1024px */
            @media screen and (max-width: 1024px) {
                .${widgetClass} .desktop-nav,
                .${widgetClass} .desktop-pagination {
                    display: none !important;
                }
                .${widgetClass} .mobile-nav-row {
                    display: flex !important;
                    justify-content: center;
                    align-items: center;
                    gap: 1rem;
                    margin-top: 2rem;
                    padding: 0 1rem;
                    width: 100%;
                }
                .${widgetClass} .mobile-nav-row .swiper-button-next,
                .${widgetClass} .mobile-nav-row .swiper-button-prev {
                    position: relative;
                    width: 2.5rem;
                    height: 2.5rem;
                    margin: 0;
                    display: flex !important;
                    align-items: center;
                    justify-content: center;
                    color: var(--pr-accent-color, #6a5acd);
                    background: var(--pr-card-bg, #fff);
                    border-radius: 50%;
                    border: 1px solid var(--pr-border-color, #cccccc);
                    box-shadow: var(--pr-shadow, 0 2px 4px rgba(0, 0, 0, 0.1));
                    transition: all 0.3s ease;
                    transform: none;
                    top: auto;
                    left: auto;
                    right: auto;
                }
                .${widgetClass} .mobile-nav-row .swiper-button-next:after,
                .${widgetClass} .mobile-nav-row .swiper-button-prev:after {
                    font-size: 1rem;
                    font-weight: bold;
                }
                .${widgetClass} .mobile-nav-row .swiper-pagination {
                    position: relative;
                    bottom: auto;
                    width: auto;
                    flex: 1;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    gap: 0.5rem;
                    margin: 0;
                }
                .${widgetClass} .mobile-nav-row .swiper-button-next:hover,
                .${widgetClass} .mobile-nav-row .swiper-button-prev:hover {
                    background: var(--pr-accent-color, #6a5acd);
                    color: #fff;
                }
            }

            /* Responsive Styles */
            @media screen and (max-width: 1024px) {
                .${widgetClass} .pr-review-card {
                    min-width: 280px;
                    max-width: 420px;
                    padding: 1.5rem;
                }
                .${widgetClass} .widget-carousel-container {
                    padding: 0;
                }
                .${widgetClass} .swiper {
                    padding: 1rem 0;
                }
                .${widgetClass} .swiper-slide {
                    display: flex;
                    justify-content: center;
                    align-items: stretch;
                }
            }

            @media screen and (max-width: 480px) {
                .${widgetClass} .pr-review-card {
                    min-width: 280px;
                    max-width: 320px;
                    margin: 0 auto;
                }
            }
        `}function addWidgetCSS(widgetClass,cssContent){const styleId=`pr-widget-style-${widgetClass}`;if(!document.getElementById(styleId)){const styleElement=document.createElement("style");styleElement.id=styleId;styleElement.textContent=cssContent;document.head.appendChild(styleElement);console.log(`Widget CSS added to page for class: ${widgetClass}`)}}function renderMultiWidget(container,widgetData){console.log("renderMultiWidget called",widgetData);if(!container||!widgetData||!widgetData.reviews){console.error("Invalid container or widget data");return}waitForSwiper(()=>{try{console.log("Inside renderMultiWidget try block");const widgetClass=`pr-multi-widget-${Math.random().toString(36).substr(2,9)}`;const widgetContainer=document.createElement("div");widgetContainer.className=widgetClass;container.appendChild(widgetContainer);console.log("Widget container created with class:",widgetClass);const cssContent=generateScopedCSS(widgetClass);addWidgetCSS(widgetClass,cssContent);const widgetContent=document.createElement("div");widgetContent.className="widget-content";widgetContainer.appendChild(widgetContent);const carouselContainer=document.createElement("div");carouselContainer.className="widget-carousel-container";widgetContent.appendChild(carouselContainer);const swiperContainer=document.createElement("div");swiperContainer.className=`swiper ${widgetClass}-swiper`;carouselContainer.appendChild(swiperContainer);const swiperWrapper=document.createElement("div");swiperWrapper.className="swiper-wrapper";swiperContainer.appendChild(swiperWrapper);const prevButton=document.createElement("div");prevButton.className="swiper-button-prev nav-button desktop-nav";prevButton.setAttribute("aria-label","Previous");prevButton.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';const nextButton=document.createElement("div");nextButton.className="swiper-button-next nav-button desktop-nav";nextButton.setAttribute("aria-label","Next");nextButton.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 6L15 12L9 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';const desktopPagination=document.createElement("div");desktopPagination.className="swiper-pagination desktop-pagination";const mobileNavRow=document.createElement("div");mobileNavRow.className="mobile-nav-row";const prevMobile=document.createElement("div");prevMobile.className="swiper-button-prev nav-button mobile-nav";prevMobile.setAttribute("aria-label","Previous");prevMobile.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';const nextMobile=document.createElement("div");nextMobile.className="swiper-button-next nav-button mobile-nav";nextMobile.setAttribute("aria-label","Next");nextMobile.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 6L15 12L9 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';const mobilePagination=document.createElement("div");mobilePagination.className="swiper-pagination mobile-pagination";mobileNavRow.appendChild(prevMobile);mobileNavRow.appendChild(mobilePagination);mobileNavRow.appendChild(nextMobile);carouselContainer.appendChild(prevButton);carouselContainer.appendChild(nextButton);swiperContainer.appendChild(desktopPagination);widgetContent.appendChild(mobileNavRow);console.log("MOBILE NAV ROW APPENDED:",mobileNavRow);const mappedReviews=(widgetData.reviews||[]).map(review=>({...review,content:review.content||review.review_content||"",name:review.name||review.reviewer_name||(review.first_name||review.reviewer_first_name||"")+(review.last_name||review.reviewer_last_name?" "+(review.last_name||review.reviewer_last_name):"")||review.reviewer&&(review.reviewer.name||(review.reviewer.first_name||"")+(review.reviewer.last_name?" "+review.reviewer.last_name:""))||"Anonymous",role:review.role||review.reviewer_role||"",rating:review.rating||review.star_rating||5,date:review.date||review.created_at||(new Date).toISOString()})).filter(review=>review&&typeof review==="object"&&review.content&&review.name);if(!mappedReviews.length){widgetContainer.innerHTML='<div class="text-center text-gray-400 py-12">No reviews to display.</div>';console.log("renderMultiWidget: returning early due to no reviews");return}mappedReviews.forEach(review=>{const slide=document.createElement("div");slide.className="swiper-slide";const card=document.createElement("div");card.className="pr-review-card";card.innerHTML=renderStars(review.rating);const content=document.createElement("div");content.className="review-content";content.innerHTML=`
                        <div class="decorative-quote decorative-quote-open">\u201C</div>
                        <div class="review-text">${review.content}</div>
                        <div class="decorative-quote decorative-quote-close">\u201D</div>
                    `;card.appendChild(content);const details=document.createElement("div");details.className="reviewer-details";const name=document.createElement("div");name.className="reviewer-name";name.textContent=review.name;details.appendChild(name);if(review.role){const role=document.createElement("div");role.className="reviewer-role";role.textContent=review.role;details.appendChild(role)}if(review.date){const date=document.createElement("div");date.className="reviewer-date";date.textContent=getRelativeTime(review.date);details.appendChild(date)}card.appendChild(details);slide.appendChild(card);swiperWrapper.appendChild(slide)});if(widgetData.design){const d=widgetData.design;if(d.accentColor)widgetContainer.style.setProperty("--pr-accent-color",d.accentColor);if(d.bgColor)widgetContainer.style.setProperty("--pr-bg-color",d.bgColor);if(d.bgOpacity!==undefined)widgetContainer.style.setProperty("--pr-bg-opacity",d.bgOpacity);if(d.textColor)widgetContainer.style.setProperty("--pr-text-color",d.textColor);if(d.bodyTextColor)widgetContainer.style.setProperty("--pr-body-text-color",d.bodyTextColor);if(d.nameTextColor)widgetContainer.style.setProperty("--pr-name-text-color",d.nameTextColor);if(d.roleTextColor)widgetContainer.style.setProperty("--pr-role-text-color",d.roleTextColor);if(d.borderWidth!==undefined)widgetContainer.style.setProperty("--pr-border-width",`${d.borderWidth}px`);if(d.borderColor)widgetContainer.style.setProperty("--pr-border-color",d.borderColor);if(d.borderRadius)widgetContainer.style.setProperty("--pr-border-radius",`${d.borderRadius}px`);if(d.shadowColor){const hex=d.shadowColor.replace("#","");const r=parseInt(hex.substr(0,2),16);const g=parseInt(hex.substr(2,2),16);const b=parseInt(hex.substr(4,2),16);widgetContainer.style.setProperty("--pr-shadow-color",`${r}, ${g}, ${b}`)}if(d.shadowIntensity!==undefined)widgetContainer.style.setProperty("--pr-shadow-intensity",d.shadowIntensity);if(d.attributionFontSize!==undefined)widgetContainer.style.setProperty("--pr-attribution-font-size",`${d.attributionFontSize}px`);if(d.quoteFontSize!==undefined)widgetContainer.style.setProperty("--pr-quote-font-size",`${d.quoteFontSize}px`);if(d.lineSpacing!==undefined)widgetContainer.style.setProperty("--pr-line-spacing",d.lineSpacing);if(d.font){widgetContainer.style.fontFamily=d.font;widgetContainer.style.setProperty("--pr-font",d.font)}}const swiperOptions={slidesPerView:1,spaceBetween:24,loop:true,observer:true,observeParents:true,centeredSlides:true,breakpoints:{0:{slidesPerView:1,spaceBetween:16,centeredSlides:true,navigation:{nextEl:".mobile-nav-row .swiper-button-next",prevEl:".mobile-nav-row .swiper-button-prev"},pagination:{el:".mobile-nav-row .swiper-pagination",clickable:true}},1025:{slidesPerView:2,spaceBetween:24,centeredSlides:false,navigation:{nextEl:".swiper-button-next.nav-button.desktop-nav",prevEl:".swiper-button-prev.nav-button.desktop-nav"},pagination:{el:".swiper-pagination.desktop-pagination",clickable:true}},1200:{slidesPerView:3,spaceBetween:24,centeredSlides:true,navigation:{nextEl:".swiper-button-next.nav-button.desktop-nav",prevEl:".swiper-button-prev.nav-button.desktop-nav"},pagination:{el:".swiper-pagination.desktop-pagination",clickable:true}}}};const swiper=new Swiper(swiperContainer,swiperOptions);console.log("SWIPER INITIALIZED:",swiper,"swiperOptions:",swiperOptions);if(!swiper){throw new Error("Failed to initialize Swiper")}const handleKeyDown=e=>{if(e.key==="ArrowLeft"){swiper.slidePrev()}else if(e.key==="ArrowRight"){swiper.slideNext()}};document.addEventListener("keydown",handleKeyDown);const cleanup=()=>{document.removeEventListener("keydown",handleKeyDown);const styleElement=document.getElementById(`pr-widget-style-${widgetClass}`);if(styleElement){styleElement.remove()}if(swiper&&swiper.destroy){swiper.destroy(true,true)}};widgetContainer._cleanup=cleanup;console.log("Widget container class:",widgetContainer.className,"style:",widgetContainer.style.cssText)}catch(error){console.error("Error rendering widget:",error);container.innerHTML=`
                    <div class="p-4 bg-red-50 border border-red-200 rounded-lg">
                        <h3 class="text-red-800 font-semibold">Widget Error</h3>
                        <p class="text-red-600 text-sm mt-2">${error.message}</p>
                    </div>
                `;console.log("renderMultiWidget: returning early due to error")}})}async function loadMultiWidgets(){const widgets=document.querySelectorAll('.promptreviews-widget[data-widget-type="multi"]');for(const widget of widgets){const widgetId=widget.getAttribute("data-widget");if(!widgetId)continue;try{const response=await fetch(`/api/widgets/${widgetId}`);if(!response.ok)throw new Error("Failed to load widget data");const data=await response.json();renderMultiWidget(widget,data)}catch(error){console.error("Error loading widget:",error);widget.innerHTML='<div class="error">Failed to load widget</div>'}}}document.addEventListener("DOMContentLoaded",loadMultiWidgets);window.PromptReviews.renderMultiWidget=renderMultiWidget;console.log("Widget script loaded successfully")})()}async function fetchWidgetData(widgetId){const supabase=createBrowserClient(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);const{data,error}=await supabase.from("widgets").select("*").eq("id",widgetId).single();if(error||!data){console.error("Error fetching widget data:",error);return null}return data}function getDesignWithDefaults(userDesign={},widgetType="multi"){const defaultDesign={multi:{font:"Inter, system-ui, -apple-system, sans-serif",accentColor:"#6a5acd",bgColor:"white",bgOpacity:1,textColor:"#333333",nameTextColor:"#111111",roleTextColor:"#666666",border:false,borderWidth:2,borderColor:"#cccccc",borderRadius:"1.5rem",shadow:true,shadowColor:"#222222",shadowIntensity:.2,showQuotes:true,showRelativeDate:true,showSubmitReviewButton:true,autoAdvance:false,slideshowSpeed:4,attributionFontSize:14}};return{...defaultDesign[widgetType],...userDesign}}async function initializeWidget(widgetId){const data=await fetchWidgetData(widgetId);if(!data){console.error("Failed to fetch widget data");return}const design=getDesignWithDefaults(data.design,data.widget_type);const container=document.getElementById("promptreviews-widget");if(!container){console.error("Widget container not found");return}container.style.setProperty("--pr-accent-color",design.accentColor);container.style.setProperty("--pr-bg-color",design.bgColor);container.style.setProperty("--pr-bg-opacity",design.bgOpacity);container.style.setProperty("--pr-text-color",design.textColor);container.style.setProperty("--pr-name-text-color",design.nameTextColor);container.style.setProperty("--pr-role-text-color",design.roleTextColor);container.style.setProperty("--pr-border-width",`${design.borderWidth}px`);container.style.setProperty("--pr-border-color",design.borderColor);container.style.setProperty("--pr-border-radius",design.borderRadius);if(design.shadowColor){const hex=design.shadowColor.replace("#","");const r=parseInt(hex.substr(0,2),16);const g=parseInt(hex.substr(2,2),16);const b=parseInt(hex.substr(4,2),16);container.style.setProperty("--pr-shadow-color",`${r}, ${g}, ${b}`)}if(design.shadowIntensity!==undefined)container.style.setProperty("--pr-shadow-intensity",design.shadowIntensity);if(design.attributionFontSize!==undefined)container.style.setProperty("--pr-attribution-font-size",`${design.attributionFontSize}px`);const swiperOptions={slidesPerView:1,spaceBetween:30,loop:true,observer:true,observeParents:true,breakpoints:{0:{slidesPerView:1,spaceBetween:16,centeredSlides:true,navigation:{nextEl:".mobile-nav-row .swiper-button-next",prevEl:".mobile-nav-row .swiper-button-prev"},pagination:{el:".mobile-nav-row .swiper-pagination",clickable:true}},1025:{slidesPerView:2,spaceBetween:24,centeredSlides:false,navigation:{nextEl:".swiper-button-next.nav-button.desktop-nav",prevEl:".swiper-button-prev.nav-button.desktop-nav"},pagination:{el:".swiper-pagination.desktop-pagination",clickable:true}},1200:{slidesPerView:3,spaceBetween:24,centeredSlides:true,navigation:{nextEl:".swiper-button-next.nav-button.desktop-nav",prevEl:".swiper-button-prev.nav-button.desktop-nav"},pagination:{el:".swiper-pagination.desktop-pagination",clickable:true}}}}}