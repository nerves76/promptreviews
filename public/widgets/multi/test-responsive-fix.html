<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi Widget - Responsive Fix Test</title>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="/widgets/multi/multi-widget.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        .debug-info {
            background: #f3e5f5;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #9c27b0;
            font-family: monospace;
            font-size: 14px;
        }
        .widget-container {
            border: 2px dashed #ccc;
            padding: 20px;
            margin: 20px 0;
            min-height: 400px;
            position: relative;
        }
        .breakpoint-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #333;
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
        }
        .test-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-primary { background: #2196f3; color: white; }
        .btn-secondary { background: #757575; color: white; }
        .btn-success { background: #4caf50; color: white; }
        .btn-warning { background: #ff9800; color: white; }
    </style>
</head>
<body>
    <div class="breakpoint-indicator" id="breakpointIndicator">
        Loading...
    </div>

    <div class="test-container">
        <h1>ðŸŽ¯ Multi Widget - Responsive Fix Test</h1>
        
        <div class="instructions">
            <h3>ðŸ“‹ Test Instructions:</h3>
            <ol>
                <li><strong>Resize your browser window</strong> to test responsive behavior</li>
                <li><strong>Desktop (â‰¥1024px):</strong> Should show 3 cards</li>
                <li><strong>Tablet (768px-1023px):</strong> Should show 2 cards</li>
                <li><strong>Mobile (<768px):</strong> Should show 1 card</li>
                <li>Use the debug buttons below to check Swiper state</li>
            </ol>
        </div>

        <div class="test-buttons">
            <button class="btn-primary" onclick="checkSwiperState()">Check Swiper State</button>
            <button class="btn-secondary" onclick="forceSwiperUpdate()">Force Swiper Update</button>
            <button class="btn-success" onclick="checkContainerWidth()">Check Container Width</button>
            <button class="btn-warning" onclick="toggleBreakpointIndicator()">Toggle Breakpoint Indicator</button>
        </div>

        <div class="debug-info" id="debugInfo">
            <strong>Debug Info:</strong><br>
            Waiting for widget to load...
        </div>

        <div class="widget-container">
            <div id="promptreviews-widget" data-widget-id="test-responsive"></div>
        </div>
    </div>

    <script src="/widgets/multi/widget-embed.js"></script>
    <script>
        // Test data
        const testData = {
            reviews: [
                {
                    id: '1',
                    review_content: 'Amazing service! The team went above and beyond to deliver exactly what we needed. Highly recommend!',
                    first_name: 'John',
                    last_name: 'S.',
                    reviewer_role: 'Verified Customer',
                    created_at: new Date().toISOString(),
                    star_rating: 5
                },
                {
                    id: '2',
                    review_content: 'Excellent service and great quality. Highly recommend to anyone looking for this type of solution.',
                    first_name: 'Sarah',
                    last_name: 'J.',
                    reviewer_role: 'Happy Client',
                    created_at: new Date().toISOString(),
                    star_rating: 5
                },
                {
                    id: '3',
                    review_content: 'Outstanding experience from start to finish. The team was professional and delivered exactly what we needed.',
                    first_name: 'Mike',
                    last_name: 'D.',
                    reviewer_role: 'Business Owner',
                    created_at: new Date().toISOString(),
                    star_rating: 5
                },
                {
                    id: '4',
                    review_content: 'Fantastic results! The quality exceeded our expectations and the process was smooth throughout.',
                    first_name: 'Lisa',
                    last_name: 'M.',
                    reviewer_role: 'Satisfied Customer',
                    created_at: new Date().toISOString(),
                    star_rating: 5
                },
                {
                    id: '5',
                    review_content: 'Great communication and timely delivery. Would definitely work with them again!',
                    first_name: 'David',
                    last_name: 'K.',
                    reviewer_role: 'Returning Client',
                    created_at: new Date().toISOString(),
                    star_rating: 5
                }
            ],
            design: {
                bgType: "solid",
                bgColor: "#ffffff",
                textColor: "#22223b",
                accentColor: "#6a5acd",
                bodyTextColor: "#22223b",
                nameTextColor: "#1a237e",
                roleTextColor: "#6b7280",
                attributionFontSize: 15,
                borderRadius: 16,
                shadow: true,
                bgOpacity: 1,
                autoAdvance: false,
                slideshowSpeed: 4,
                border: true,
                borderWidth: 2,
                lineSpacing: 1.4,
                showQuotes: false,
                showRelativeDate: false,
                showGrid: false,
                width: 1000,
                sectionBgType: "none",
                sectionBgColor: "#ffffff",
                shadowIntensity: 0.2,
                shadowColor: "#222222",
                borderColor: "#cccccc",
                font: "Inter",
                showSubmitReviewButton: true,
            },
            businessSlug: 'test-business'
        };

        // Initialize widget when script is ready
        function initWidget() {
            const container = document.getElementById('promptreviews-widget');
            if (container && window.PromptReviews?.renderMultiWidget) {
                window.PromptReviews.renderMultiWidget(container, testData);
                updateDebugInfo('Widget initialized');
            } else {
                setTimeout(initWidget, 100);
            }
        }

        // Update breakpoint indicator
        function updateBreakpointIndicator() {
            const indicator = document.getElementById('breakpointIndicator');
            const width = window.innerWidth;
            let breakpoint = 'Mobile (<768px)';
            let cards = '1 card';
            
            if (width >= 1024) {
                breakpoint = 'Desktop (â‰¥1024px)';
                cards = '3 cards';
            } else if (width >= 768) {
                breakpoint = 'Tablet (768px-1023px)';
                cards = '2 cards';
            }
            
            indicator.innerHTML = `${breakpoint}<br>Expected: ${cards}<br>Width: ${width}px`;
        }

        // Debug functions
        function checkSwiperState() {
            const container = document.getElementById('promptreviews-widget');
            const swiper = container?.swiperInstance;
            
            if (swiper) {
                const info = {
                    currentBreakpoint: swiper.currentBreakpoint,
                    slidesPerView: swiper.params.slidesPerView,
                    containerWidth: container.offsetWidth,
                    windowWidth: window.innerWidth,
                    slidesCount: swiper.slides.length,
                    isDestroyed: swiper.destroyed
                };
                updateDebugInfo('Swiper State: ' + JSON.stringify(info, null, 2));
            } else {
                updateDebugInfo('Swiper not found');
            }
        }

        function forceSwiperUpdate() {
            const container = document.getElementById('promptreviews-widget');
            const swiper = container?.swiperInstance;
            
            if (swiper && !swiper.destroyed) {
                swiper.update();
                updateDebugInfo('Swiper updated');
                checkSwiperState();
            } else {
                updateDebugInfo('Cannot update - Swiper not found or destroyed');
            }
        }

        function checkContainerWidth() {
            const container = document.getElementById('promptreviews-widget');
            const info = {
                containerWidth: container?.offsetWidth,
                containerMaxWidth: container?.style.maxWidth,
                containerWidthStyle: container?.style.width,
                windowWidth: window.innerWidth
            };
            updateDebugInfo('Container Width: ' + JSON.stringify(info, null, 2));
        }

        function toggleBreakpointIndicator() {
            const indicator = document.getElementById('breakpointIndicator');
            indicator.style.display = indicator.style.display === 'none' ? 'block' : 'none';
        }

        function updateDebugInfo(message) {
            const debugInfo = document.getElementById('debugInfo');
            const timestamp = new Date().toLocaleTimeString();
            debugInfo.innerHTML = `<strong>Debug Info (${timestamp}):</strong><br>${message}`;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateBreakpointIndicator();
            initWidget();
            
            // Update on resize
            window.addEventListener('resize', function() {
                updateBreakpointIndicator();
                setTimeout(checkSwiperState, 100); // Check after resize
            });
        });
    </script>
</body>
</html> 