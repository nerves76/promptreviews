!function(){"use strict";function t(t,n){if(!t||0===t.length)return"";const e=(t.reduce((t,n)=>t+(n.star_rating||0),0)/t.length).toFixed(1),o=t.length,r={"@context":"https://schema.org","@type":"Product",name:n||document.title||"Business",aggregateRating:{"@type":"AggregateRating",ratingValue:e,bestRating:"5",worstRating:"1",ratingCount:o,reviewCount:o},review:t.slice(0,5).map(t=>({"@type":"Review",reviewRating:{"@type":"Rating",ratingValue:t.star_rating||5,bestRating:"5",worstRating:"1"},author:{"@type":"Person",name:`${t.first_name||""} ${t.last_name||""}`.trim()||"Anonymous"},datePublished:t.created_at,reviewBody:t.review_content}))};return`<script type="application/ld+json">${JSON.stringify(r)}<\/script>`}function n(t,n){if(!t)return"";const e=new Date(t),o=new Date,r=Math.round((o-e)/1e3),i=Math.round(r/60),a=Math.round(i/60),s=Math.round(a/24),d=Math.round(s/7),p=Math.round(s/30.44),l=Math.round(s/365.25);return n?r<60?`${r} second${1!==r?"s":""} ago`:i<60?`${i} minute${1!==i?"s":""} ago`:a<24?`${a} hour${1!==a?"s":""} ago`:s<7?`${s} day${1!==s?"s":""} ago`:d<5?`${d} week${1!==d?"s":""} ago`:p<12?`${p} month${1!==p?"s":""} ago`:`${l} year${1!==l?"s":""} ago`:1===s?"1 day ago":s<7?`${s} days ago`:s<30?`${Math.floor(s/7)} weeks ago`:s<365?`${Math.floor(s/30)} months ago`:`${Math.floor(s/365)} years ago`}function e(t,n){if(!t||!t.startsWith("#"))return t;return`rgba(${parseInt(t.slice(1,3),16)}, ${parseInt(t.slice(3,5),16)}, ${parseInt(t.slice(5,7),16)}, ${n})`}const o=void 0!==t?t:function(){return""},r=void 0!==e?e:function(t,n){return t},i=new Set;let a={};window.PromptReviewsPhoto=window.PromptReviewsPhoto||{},window.PromptReviewsPhoto.initializeWidget||(window.PromptReviewsPhoto.initializeWidget=function(t,e,p,l,c){if(console.log("üöÄ PhotoWidget: Initializing widget",{containerId:t,reviewsCount:e?.length,design:p}),s(p),!e||0===e.length)return void console.warn("‚ö†Ô∏è PhotoWidget: No reviews provided");const h=document.getElementById(t);if(!h)return void console.error("‚ùå PhotoWidget: Widget container not found:",t);i.add(t);const g=function(t,e,i,s,d){!function(t,n,e){a[t]={currentIndex:0,totalItems:n.length,itemsPerView:1,autoAdvance:e.autoAdvance||!1,slideshowSpeed:e.slideshowSpeed||4,autoAdvanceInterval:null}}(t,e,i);const p=a[t],l=e.map(t=>`<div class="pr-photo-carousel-item">${function(t,e){const o=e.showQuotes?`&#8220;${t.review_content}&#8221;`:t.review_content,i=e.showRelativeDate?(p=t.created_at,void 0!==n?n(p,!1):""):new Date(t.created_at).toLocaleDateString(),a=e.showPlatform&&t.platform?` via ${t.platform}`:"",s=t.star_rating?function(t,n){const e=n.accentColor||"#4f46e5",o="#cccccc";let r="";for(let n=1;n<=5;n++)r+=n<=t?`<span style="color: ${e};">&#9733;</span>`:n-.5<=t?`<span style="position: relative; display: inline-block; color: ${o};">\n                            &#9733;\n                            <span style="position: absolute; left: 0; top: 0; width: 50%; overflow: hidden; color: ${e};">\n                                &#9733;\n                            </span>\n                        </span>`:`<span style="color: ${o};">&#9733;</span>`;return`<div class="pr-photo-stars-row" style="display: flex; justify-content: center; margin-bottom: 1rem;">${r}</div>`}(t.star_rating,e):"",d=t.photo_url&&""!==t.photo_url.trim();var p;console.log("üîç PhotoWidget: Review photo check:",{reviewId:t.id,photoUrl:t.photo_url,hasPhoto:d,reviewData:t});const l=e.bgColor||"#ffffff",c=void 0!==e.bgOpacity?e.bgOpacity:1,h=r(l,c),g=e.borderColor||"#cccccc",u=void 0!==e.borderOpacity?e.borderOpacity:1,m=u<1&&g.startsWith("#")?r(g,u):g,w=d?`\n      <div class="pr-photo-review-image" style="\n        width: 50%;\n        height: 100%;\n        position: absolute;\n        left: 0;\n        top: 0;\n        overflow: hidden;\n        border-top-left-radius: ${e.borderRadius||16}px;\n        border-bottom-left-radius: ${e.borderRadius||16}px;\n      ">\n        <img src="${t.photo_url}" alt="Review photo" style="\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n        " />\n      </div>\n    `:"";let f=[];if(e.shadow){const t=e.shadowColor||"#000000",n=e.shadowIntensity||.2,o=t.startsWith("#")?r(t,n):`rgba(0, 0, 0, ${n})`;f.push(`0 4px 6px -1px ${o}`)}if(e.innerShadow){const t=e.innerShadowColor||"#FFFFFF",n=e.innerShadowOpacity||.5,o=t.startsWith("#")?r(t,n):`rgba(255, 255, 255, ${n})`;f.push(`inset 0 1px 3px ${o}`)}const v=f.length>0?f.join(", "):"none",b=e.backdropBlur||10,x=`backdrop-filter: blur(${b}px); -webkit-backdrop-filter: blur(${b}px);`;return`\n      <div class="pr-photo-review-card" style="\n        background-color: ${h};\n        ${e.border?`border: ${e.borderWidth||2}px solid ${m};`:"border: none;"}\n        border-radius: ${e.borderRadius||16}px;\n        color: ${e.textColor||"#22223b"};\n        font-family: ${e.font||"Inter"}, sans-serif;\n        line-height: ${e.lineSpacing||1.4};\n        box-shadow: ${v};\n        ${x}\n        padding: 0;\n        position: relative;\n        overflow: hidden;\n        min-height: 300px;\n      ">\n        ${d?w:""}\n        <div class="pr-photo-review-content" style="\n          display: flex;\n          height: 100%;\n          min-height: 300px;\n        ">\n          <div class="pr-photo-review-text-content" style="\n            flex: 1;\n            padding: 1.5rem;\n            ${d?"margin-left: 50%;":""}\n          ">\n            ${s}\n            <p class="pr-photo-review-text" style="margin-bottom: 1rem;">${o}</p>\n            <div class="pr-photo-reviewer-details">\n              <div style="\n                color: ${e.nameTextColor||"#1a237e"};\n                font-weight: 600;\n                margin-bottom: 0.25rem;\n              ">${t.first_name||""} ${t.last_name||""}</div>\n              ${t.reviewer_role?`<div style="\n                color: ${e.nameTextColor||"#1a237e"};\n                opacity: 0.65;\n                font-size: ${e.attributionFontSize||15}px;\n              ">${t.reviewer_role}</div>`:""}\n              <div style="\n                color: ${e.roleTextColor||"#6b7280"};\n                font-size: 0.75rem;\n                margin-top: 0.125rem;\n              ">${i}${a}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}(t,i)}</div>`).join(""),c='<div class="pr-photo-dots-container"></div>',h=i.bgColor||"#ffffff",g=i.borderColor||"#cccccc",u=i.borderWidth||2,m=void 0!==i.bgOpacity?i.bgOpacity:1,w=void 0!==i.borderOpacity?i.borderOpacity:1,f=i.accentColor||"#4f46e5",v=w<1?r(g,w):g,b=m<1?r(h,m):h,x=`\n      background-color: ${b};\n      border: ${u}px solid ${v};\n    `,y=`\n      background-color: ${b};\n      border: ${u}px solid ${v};\n      border-radius: ${i.buttonBorderRadius||8}px;\n      color: ${f};\n    `,$=`\n      <style>\n        /* Arrow Color */\n        .pr-photo-prev-btn::before { border-color: transparent ${f} transparent transparent !important; }\n        .pr-photo-next-btn::before { border-color: transparent transparent transparent ${f} !important; }\n        \n        /* Arrow & Submit Button Hover: Invert colors */\n        .pr-photo-prev-btn:hover, .pr-photo-next-btn:hover, .pr-photo-submit-btn:hover {\n          background-color: ${f} !important;\n          color: ${h} !important;\n        }\n        \n        /* Arrow Icon Hover: Change to background color */\n        .pr-photo-prev-btn:hover::before { border-color: transparent ${h} transparent transparent !important; }\n        .pr-photo-next-btn:hover::before { border-color: transparent transparent transparent ${h} !important; }\n\n        /* Card Hover: Lift effect */\n        .pr-photo-review-card {\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n        .pr-photo-review-card:hover {\n          transform: ${i.liftOnHover?"translateY(-5px)":"none"};\n          box-shadow: ${i.liftOnHover?`0 10px 15px -3px rgba(0, 0, 0, ${i.shadowIntensity||.2})`:i.shadow?`0 4px 6px -1px rgba(0, 0, 0, ${i.shadowIntensity||.2})`:"none"};\n        }\n\n        /* Responsive design for photo widget */\n        @media (max-width: 768px) {\n          .pr-photo-review-content {\n            flex-direction: column !important;\n            height: auto !important;\n            min-height: auto !important;\n          }\n          .pr-photo-review-image {\n            width: 100% !important;\n            height: 200px !important;\n            position: relative !important;\n            border-radius: ${i.borderRadius||16}px ${i.borderRadius||16}px 0 0 !important;\n            margin-bottom: 0 !important;\n          }\n          .pr-photo-review-text-content {\n            margin-left: 0 !important;\n            padding: 1.5rem !important;\n          }\n        }\n      </style>\n    `,I=p.totalItems>1?`\n      <div class="pr-photo-carousel-controls">\n        <button class="pr-photo-prev-btn" style="${x}" title="Previous review"></button>\n        ${c}\n        <button class="pr-photo-next-btn" style="${x}" title="Next review"></button>\n      </div>\n    `:"",P=d?`https://app.promptreviews.app/r/${s}?src=widget&wid=${d}&utm_medium=widget`:`https://app.promptreviews.app/r/${s}?src=widget&utm_medium=widget`,S=i.showSubmitReviewButton?`\n      <div class="pr-photo-submit-review-container">\n        <a href="${P}" target="_blank" class="pr-photo-submit-btn" style="${y}">\n          Submit a Review\n        </a>\n      </div>\n    `:"",k=o(e,null);return`\n      ${k}\n      ${$}\n      <div class="pr-photo-carousel-container">\n        <div class="pr-photo-carousel-track">\n          ${l}\n        </div>\n      </div>\n      ${I}\n      ${S}\n    `}(t,e,p,l,c);h.innerHTML=g,h.classList.add("pr-photo-widget"),function(t){const n=a[t];if(!n)return;const e=document.getElementById(t),o=(e.querySelector(".pr-photo-carousel-track"),e.querySelector(".pr-photo-prev-btn")),r=e.querySelector(".pr-photo-next-btn");o&&o.addEventListener("click",()=>{n.currentIndex>0&&(n.currentIndex--,d(t))});r&&r.addEventListener("click",()=>{n.currentIndex<n.totalItems-1&&(n.currentIndex++,d(t))});n.autoAdvance&&n.totalItems>1&&(n.autoAdvanceInterval=setInterval(()=>{n.currentIndex<n.totalItems-1?n.currentIndex++:n.currentIndex=0,d(t)},1e3*n.slideshowSpeed));d(t)}(t),i.delete(t),console.log("‚úÖ PhotoWidget: Widget initialized successfully")});const s=t=>{const n="pr-photo-widget-styles";if(document.getElementById(n))return;const e=document.createElement("style");e.id=n,e.type="text/css",e.innerText='/* \n  Canonical CSS for the Photo-Widget.\n  This file is the single source of truth for styling the photo-widget,\n  used by both the dashboard preview and the live embeddable widget.\n*/\n\n/* \n  Container styles to mimic the dashboard preview environment.\n  This ensures the embedded widget has a consistent, centered,\n  and responsive container, just like in the app.\n*/\n#promptreviews-photo-widget {\n    position: relative;\n    width: 100%;\n    max-width: 64rem; /* 1024px */\n    margin-left: auto;\n    margin-right: auto;\n    font-size: 16px; /* Set a consistent base font size for rem calculations */\n}\n\n/* \n  Base widget container style.\n  This handles the sizing and centering of the widget itself,\n  both in the dashboard preview and on live sites.\n*/\n.pr-photo-widget {\n  all: revert;\n  box-sizing: border-box;\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n\n  /* Sizing */\n  width: 100%;\n  max-width: 650px !important;\n  min-height: 300px !important;\n\n  /* Centering */\n  margin: auto; /* Centers horizontally and vertically within a flex container like the preview */\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n\n  /* Padding */\n  padding: 0 1rem;\n\n  /* Font size */\n  font-size: 16px !important;\n}\n\n/* Enforce minimum font sizes for readability */\n.pr-photo-widget .pr-photo-review-text {\n  font-size: 14px !important;\n}\n\n.pr-photo-widget .pr-photo-reviewer-name {\n  font-size: 14px !important;\n}\n\n.pr-photo-widget .pr-photo-reviewer-role {\n  font-size: 13px !important;\n}\n\n.pr-photo-widget .pr-photo-reviewer-date,\n.pr-photo-widget .pr-photo-reviewer-platform {\n  font-size: 12px !important;\n}\n  \n/* Carousel Layout */\n.pr-photo-carousel-container {\n    position: relative;\n    overflow: hidden;\n    width: 100%;\n    min-height: 300px; /* Ensure carousel has minimum height */\n}\n  \n.pr-photo-carousel-track {\n    display: flex;\n    transition: transform 0.5s ease;\n    gap: 0; /* No gap for photo widget */\n    min-height: 300px; /* Ensure track has minimum height */\n}\n  \n/* Single card takes full width */\n.pr-photo-carousel-item {\n    flex-shrink: 0;\n    width: 100%; /* Full width for single card */\n    display: flex; \n    min-height: 300px; /* Ensure item has minimum height */\n}\n  \n/* Review Card Styles */\n.pr-photo-widget .pr-photo-review-card {\n    background: var(--pr-card-bg, #fff);\n    border: var(--pr-card-border, 2px solid #cccccc);\n    border-radius: var(--pr-card-radius, 16px);\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    text-align: center;\n    flex-grow: 1; \n    min-height: 300px; /* Ensure card has minimum height */\n}\n  \n.pr-photo-widget .pr-photo-review-content {\n    flex-grow: 1; /* Ensures the text content area grows, pushing footer down */\n}\n  \n.pr-photo-widget .pr-photo-reviewer-details {\n    margin-top: auto; /* Pushes details to the bottom of the card */\n}\n  \n/* --- Other existing styles below --- */\n  \n.pr-photo-widget .pr-photo-stars-row {\n    display: flex;\n    justify-content: center;\n}\n  \n.pr-photo-widget .pr-photo-review-text {\n    margin: 0;\n}\n  \n.pr-photo-carousel-controls {\n    text-align: center;\n    margin-top: 1.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 20px;\n}\n  \n.pr-photo-prev-btn,\n.pr-photo-next-btn {\n    cursor: pointer;\n    width: 34px;\n    height: 34px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n    position: relative;\n}\n\n.pr-photo-prev-btn::before,\n.pr-photo-next-btn::before {\n    content: \'\';\n    width: 0;\n    height: 0;\n    border-style: solid;\n}\n\n.pr-photo-prev-btn::before {\n    border-width: 5px 7px 5px 0;\n    border-color: transparent #4f46e5 transparent transparent;\n    margin-left: -2px;\n}\n\n.pr-photo-next-btn::before {\n    border-width: 5px 0 5px 7px;\n    border-color: transparent transparent transparent #4f46e5;\n    margin-right: -2px;\n}\n\n.pr-photo-dots-container {\n    display: flex;\n    gap: 14px;\n    align-items: center;\n}\n\n.pr-photo-dot {\n    height: 10px;\n    width: 10px;\n    border: none;\n    border-radius: 50%;\n    cursor: pointer;\n    padding: 0;\n    margin: 0;\n}\n\n.pr-photo-submit-review-container {\n    text-align: right;\n    margin-top: 0.5rem;\n}\n\n.pr-photo-submit-btn {\n    display: inline-block;\n    padding: 5px 10px;\n    text-decoration: none;\n    font-weight: 500;\n    font-size: 0.75rem;\n}\n  \n/* Responsive Design - simplified for single card */\n@media (max-width: 640px) {\n    .pr-photo-carousel-track {\n      gap: 0;\n    }\n    .pr-photo-submit-review-container {\n      margin-top: 1.5rem;\n    }\n} ',document.head.appendChild(e)};function d(t){if(i.has(t))return void console.log("üîÑ PhotoWidget: Skipping carousel update - widget is initializing:",t);const n=a[t];if(!n)return;const e=document.getElementById(t);if(!e)return void console.warn("‚ö†Ô∏è PhotoWidget: Widget element not found for ID:",t);const o=e.querySelector(".pr-photo-carousel-track");if(!o)return void console.warn("‚ö†Ô∏è PhotoWidget: Carousel track not found for widget:",t);n.itemsPerView=1;const r=e.querySelector(".pr-photo-carousel-item");if(!r)return void console.warn("‚ö†Ô∏è PhotoWidget: No carousel items found for widget:",t);const s=window.getComputedStyle(o).gap,p=parseFloat(s)||0,l=r.offsetWidth+p,c=-n.currentIndex*l;o.style.transform=`translateX(${c}px)`,function(t){const n=a[t];if(!n)return;const e=document.getElementById(t);if(!e)return void console.warn("‚ö†Ô∏è PhotoWidget: Widget element not found for dots update:",t);const o=e.querySelector(".pr-photo-dots-container");if(!o)return void console.warn("‚ö†Ô∏è PhotoWidget: Dots container not found for widget:",t);o.innerHTML="";for(let e=0;e<n.totalItems;e++){const r=document.createElement("button");r.className="pr-photo-dot "+(e===n.currentIndex?"active":""),r.style.backgroundColor=e===n.currentIndex?"#4f46e5":"#d1d5db",r.addEventListener("click",()=>{n.currentIndex=e,d(t)}),o.appendChild(r)}}(t),function(t){const n=a[t];if(!n)return;const e=document.getElementById(t);if(!e)return void console.warn("‚ö†Ô∏è PhotoWidget: Widget element not found for arrow buttons update:",t);const o=e.querySelector(".pr-photo-prev-btn"),r=e.querySelector(".pr-photo-next-btn");o&&(o.style.opacity=0===n.currentIndex?"0.5":"1",o.disabled=0===n.currentIndex);r&&(r.style.opacity=n.currentIndex===n.totalItems-1?"0.5":"1",r.disabled=n.currentIndex===n.totalItems-1)}(t)}async function p(){if(window.location.pathname.includes("/dashboard"))return void console.log("üîÑ PhotoWidget: Dashboard context detected, skipping auto-initialization");const t=document.querySelectorAll("[data-prompt-reviews-id], [data-widget-id]");if(0!==t.length){s();for(const n of t){const t=n.getAttribute("data-prompt-reviews-id")||n.getAttribute("data-widget-id");n.getAttribute("data-business-slug");n.id=`pr-widget-container-${t}`;try{const e="app.promptreviews.app"===window.location.hostname?`/api/widgets/${t}`:`https://app.promptreviews.app/api/widgets/${t}`,o=await fetch(e);if(!o.ok)throw new Error(`Failed to fetch widget data: ${o.statusText}`);const{reviews:r,design:i,businessSlug:a}=await o.json();r&&r.length>0?window.PromptReviewsPhoto.initializeWidget(n.id,r,i,a,t):n.innerHTML='\n        <div style="display: flex; align-items: center; justify-content: center; min-height: 200px; color: white; font-size: 18px;">\n          <div style="text-align: center;">\n            <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;">\n              <svg style="width: 24px; height: 24px;" fill="currentColor" viewBox="0 0 20 20">\n                <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd" />\n              </svg>\n              <span>Add reviews to your widget</span>\n            </div>\n            <p style="font-size: 14px; opacity: 0.8;">Click talk bubble icon to add and manage reviews.</p>\n          </div>\n        </div>\n      '}catch(t){console.error("Error initializing PromptReviews widget:",t),n.innerHTML="<p>Error loading reviews.</p>"}}}}window.PromptReviewsPhoto.renderPhotoWidget=function(t,n,e,o,r){window.PromptReviewsPhoto.initializeWidget(t,n,e,o,r)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",p):p(),console.log("‚úÖ PhotoWidget: Widget script loaded successfully")}();