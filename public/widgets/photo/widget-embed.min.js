!function(){"use strict";const t={};function e(e,o,r){const i=t[e];if(!i)return;const a=document.getElementById(e),s=(a.querySelector(".pr-photo-carousel-track"),a.querySelector(".pr-photo-prev-btn")),d=a.querySelector(".pr-photo-next-btn");s&&s.addEventListener("click",()=>{i.currentIndex>0&&(i.currentIndex--,n(e))}),d&&d.addEventListener("click",()=>{i.currentIndex<i.totalItems-1&&(i.currentIndex++,n(e))}),i.autoAdvance&&i.totalItems>1&&(i.autoAdvanceInterval=setInterval(()=>{i.currentIndex<i.totalItems-1?i.currentIndex++:i.currentIndex=0,n(e)},1e3*i.slideshowSpeed)),n(e)}function n(e){const o=t[e];if(!o)return;const r=document.getElementById(e),i=r.querySelector(".pr-photo-carousel-track");if(!i)return;o.itemsPerView=1;const a=r.querySelector(".pr-photo-carousel-item");if(!a)return;const s=window.getComputedStyle(i).gap,d=parseFloat(s)||0,c=a.offsetWidth+d,l=-o.currentIndex*c;i.style.transform=`translateX(${l}px)`,function(e){const o=t[e];if(!o)return;const r=document.getElementById(e),i=r.querySelector(".pr-photo-dots-container");if(!i)return;i.innerHTML="";for(let t=0;t<o.totalItems;t++){const r=document.createElement("button");r.className="pr-photo-dot "+(t===o.currentIndex?"active":""),r.style.backgroundColor=t===o.currentIndex?"#4f46e5":"#d1d5db",r.addEventListener("click",()=>{o.currentIndex=t,n(e)}),i.appendChild(r)}}(e),function(e){const n=t[e];if(!n)return;const o=document.getElementById(e),r=o.querySelector(".pr-photo-prev-btn"),i=o.querySelector(".pr-photo-next-btn");r&&(r.style.opacity=0===n.currentIndex?"0.5":"1",r.disabled=0===n.currentIndex);i&&(i.style.opacity=n.currentIndex===n.totalItems-1?"0.5":"1",i.disabled=n.currentIndex===n.totalItems-1)}(e)}function o(t,e){const n=e.showQuotes?`"${t.review_content}"`:t.review_content,o=e.showRelativeDate?function(t){const e=new Date(t),n=new Date,o=Math.abs(n-e),r=Math.ceil(o/864e5);return 1===r?"1 day ago":r<7?`${r} days ago`:r<30?`${Math.floor(r/7)} weeks ago`:r<365?`${Math.floor(r/30)} months ago`:`${Math.floor(r/365)} years ago`}(t.created_at):new Date(t.created_at).toLocaleDateString(),r=t.star_rating?function(t,e){const n=e.accentColor||"#4f46e5",o="#cccccc";let r="";for(let e=1;e<=5;e++)r+=e<=t?`<span style="color: ${n};">&#9733;</span>`:e-.5<=t?`<span style="position: relative; display: inline-block; color: ${o};">\n                            &#9733;\n                            <span style="position: absolute; left: 0; top: 0; width: 50%; overflow: hidden; color: ${n};">\n                                &#9733;\n                            </span>\n                        </span>`:`<span style="color: ${o};">&#9733;</span>`;return`<div class="pr-photo-stars-row" style="display: flex; justify-content: center; margin-bottom: 1rem;">${r}</div>`}(t.star_rating,e):"",i=t.photo_url&&""!==t.photo_url.trim(),a=e.bgColor||"#ffffff",s=void 0!==e.bgOpacity?e.bgOpacity:1,d=(c=a,l=s,`rgba(${parseInt(c.slice(1,3),16)}, ${parseInt(c.slice(3,5),16)}, ${parseInt(c.slice(5,7),16)}, ${l})`);var c,l;const p=i?`\n      <div class="pr-photo-review-image" style="\n        width: 50%;\n        height: 100%;\n        position: absolute;\n        left: 0;\n        top: 0;\n        overflow: hidden;\n        border-top-left-radius: ${e.borderRadius||16}px;\n        border-bottom-left-radius: ${e.borderRadius||16}px;\n      ">\n        <img src="${t.photo_url}" alt="Review photo" style="\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n        " />\n      </div>\n    `:"";return`\n      <div class="pr-photo-review-card" style="\n        background-color: ${d};\n        border: ${e.borderWidth||2}px solid ${e.borderColor||"#cccccc"};\n        border-radius: ${e.borderRadius||16}px;\n        color: ${e.textColor||"#22223b"};\n        font-family: ${e.font||"Inter"}, sans-serif;\n        line-height: ${e.lineSpacing||1.4};\n        box-shadow: ${e.shadow?`0 4px 6px -1px rgba(0, 0, 0, ${e.shadowIntensity||.2})`:"none"};\n        padding: 0;\n        position: relative;\n        overflow: hidden;\n        min-height: 300px;\n      ">\n        ${i?p:""}\n        <div class="pr-photo-review-content" style="\n          display: flex;\n          height: 100%;\n          min-height: 300px;\n        ">\n          <div class="pr-photo-review-text-content" style="\n            flex: 1;\n            padding: 1.5rem;\n            ${i?"margin-left: 50%;":""}\n          ">\n            ${r}\n            <p class="pr-photo-review-text" style="margin-bottom: 1rem;">${n}</p>\n            <div class="pr-photo-reviewer-details">\n              <div style="\n                color: ${e.nameTextColor||"#1a237e"};\n                font-weight: 600;\n                margin-bottom: 0.25rem;\n              ">${t.first_name||""} ${t.last_name||""}</div>\n              ${t.reviewer_role?`<div style="\n                color: ${e.roleTextColor||"#6b7280"};\n                font-size: ${e.attributionFontSize||15}px;\n              ">${t.reviewer_role}</div>`:""}\n              <div style="\n                color: ${e.roleTextColor||"#6b7280"};\n                font-size: ${e.attributionFontSize||15}px;\n                margin-top: 0.25rem;\n              ">${o}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}function r(e,n,r,i){!function(e,n,o){t[e]={currentIndex:0,totalItems:n.length,itemsPerView:1,autoAdvance:o.autoAdvance||!1,slideshowSpeed:o.slideshowSpeed||4,autoAdvanceInterval:null}}(e,n,r);const a=t[e],s=n.map(t=>`<div class="pr-photo-carousel-item">${o(t,r)}</div>`).join(""),d=r.bgColor||"#ffffff",c=r.borderColor||"#cccccc",l=r.borderWidth||2,p=void 0!==r.bgOpacity?r.bgOpacity:1,u=r.accentColor||"#4f46e5",h=`\n      background-color: ${d};\n      border: ${l}px solid ${c};\n      opacity: ${p};\n    `,v=`\n      background-color: ${d};\n      border: ${l}px solid ${c};\n      border-radius: ${r.buttonBorderRadius||8}px;\n      opacity: ${p};\n      color: ${u};\n    `;return`\n      ${`\n      <style>\n        /* Arrow Color */\n        .pr-photo-prev-btn::before { border-color: transparent ${u} transparent transparent !important; }\n        .pr-photo-next-btn::before { border-color: transparent transparent transparent ${u} !important; }\n        \n        /* Arrow & Submit Button Hover: Invert colors */\n        .pr-photo-prev-btn:hover, .pr-photo-next-btn:hover, .pr-photo-submit-btn:hover {\n          background-color: ${u} !important;\n          color: ${d} !important;\n        }\n        \n        /* Arrow Icon Hover: Change to background color */\n        .pr-photo-prev-btn:hover::before { border-color: transparent ${d} transparent transparent !important; }\n        .pr-photo-next-btn:hover::before { border-color: transparent transparent transparent ${d} !important; }\n\n        /* Card Hover: Lift effect */\n        .pr-photo-review-card {\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n        .pr-photo-review-card:hover {\n          transform: ${r.liftOnHover?"translateY(-5px)":"none"};\n          box-shadow: ${r.liftOnHover?`0 10px 15px -3px rgba(0, 0, 0, ${r.shadowIntensity||.2})`:r.shadow?`0 4px 6px -1px rgba(0, 0, 0, ${r.shadowIntensity||.2})`:"none"};\n        }\n\n        /* Responsive design for photo widget */\n        @media (max-width: 768px) {\n          .pr-photo-review-content {\n            flex-direction: column !important;\n            height: auto !important;\n            min-height: auto !important;\n          }\n          .pr-photo-review-image {\n            width: 100% !important;\n            height: 200px !important;\n            position: relative !important;\n            border-radius: ${r.borderRadius||16}px ${r.borderRadius||16}px 0 0 !important;\n            margin-bottom: 0 !important;\n          }\n          .pr-photo-review-text-content {\n            margin-left: 0 !important;\n            padding: 1.5rem !important;\n          }\n        }\n      </style>\n    `}\n      <div class="pr-photo-carousel-container">\n        <div class="pr-photo-carousel-track">\n          ${s}\n        </div>\n      </div>\n      ${a.totalItems>1?`\n      <div class="pr-photo-carousel-controls">\n        <button class="pr-photo-prev-btn" style="${h}" title="Previous review"></button>\n        <div class="pr-photo-dots-container"></div>\n        <button class="pr-photo-next-btn" style="${h}" title="Next review"></button>\n      </div>\n    `:""}\n      ${r.showSubmitReviewButton?`\n      <div class="pr-photo-submit-review-container">\n        <a href="/r/${i}?source=widget" target="_blank" class="pr-photo-submit-btn" style="${v}">\n          Submit a Review\n        </a>\n      </div>\n    `:""}\n    `}async function i(){const t=document.querySelectorAll("[data-prompt-reviews-id], [data-widget-id]");if(0!==t.length)for(const n of t){const t=n.getAttribute("data-prompt-reviews-id")||n.getAttribute("data-widget-id"),o=n.getAttribute("data-business-slug");try{const i=await fetch(`http://localhost:3001/api/widgets/${t}`);if(!i.ok)throw new Error(`Failed to fetch widget data: ${i.statusText}`);const{reviews:a,design:s}=await i.json();a&&a.length>0?(n.innerHTML=r(n.id,a,s,o),e(n.id)):n.innerHTML="<p>No reviews to display.</p>"}catch(t){console.error("Error initializing PromptReviews Photo widget:",t),n.innerHTML="<p>Error loading reviews.</p>"}}}window.PromptReviewsPhoto=window.PromptReviewsPhoto||{},window.PromptReviewsPhoto.initializeWidget||(window.PromptReviewsPhoto.initializeWidget=function(t,n,o,i){if(console.log("üöÄ PhotoWidget: Initializing widget",{containerId:t,reviewsCount:n?.length,design:o}),!n||0===n.length)return void console.warn("‚ö†Ô∏è PhotoWidget: No reviews provided");const a=document.getElementById(t);if(!a)return void console.error("‚ùå PhotoWidget: Widget container not found:",t);const s=r(t,n,o,i);a.innerHTML=s,e(t,n,o),console.log("‚úÖ PhotoWidget: Widget initialized successfully")}),window.PromptReviewsPhoto.renderPhotoWidget=function(t,e,n,o){window.PromptReviewsPhoto.initializeWidget(t,e,n,o)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i(),console.log("‚úÖ PhotoWidget: Widget script loaded successfully")}();