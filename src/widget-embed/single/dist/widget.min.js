"use strict";(()=>{var y=(c,a,d)=>new Promise((v,p)=>{var u=e=>{try{o(d.next(e))}catch(t){p(t)}},r=e=>{try{o(d.throw(e))}catch(t){p(t)}},o=e=>e.done?v(e.value):Promise.resolve(e.value).then(u,r);o((d=d.apply(c,a)).next())});(function(){window.PromptReviews=window.PromptReviews||{};function c(r,o){r.innerHTML="";let e=document.createElement("div");e.className="promptreviews-single-widget";let t=o.design||{};e.style.setProperty("--bg-color",t.bgColor||"#fff"),e.style.setProperty("--text-color",t.textColor||"#22223b"),e.style.setProperty("--accent-color",t.accentColor||"#1A237E"),e.style.setProperty("--body-text-color",t.bodyTextColor||"#22223b"),e.style.setProperty("--name-text-color",t.nameTextColor||"#1a237e"),e.style.setProperty("--role-text-color",t.roleTextColor||"#6b7280"),e.style.setProperty("--quote-font-size",`${t.quoteFontSize||18}px`),e.style.setProperty("--attribution-font-size",`${t.attributionFontSize||15}px`),e.style.setProperty("--border-radius",`${t.borderRadius||16}px`),e.style.setProperty("--line-spacing",t.lineSpacing||1.4),e.style.setProperty("--border-width",`${t.borderWidth||2}px`),e.style.setProperty("--border-color",t.borderColor||"#cccccc"),e.style.setProperty("--shadow-color",t.shadowColor||"#222222"),e.style.setProperty("--shadow-intensity",t.shadowIntensity||.2);let s=o.reviews&&o.reviews[0]||{review_content:"No reviews yet.",first_name:"",last_name:"",reviewer_role:"",star_rating:0};e.innerHTML=`
            <div class="widget-container">
                <div class="widget-content">
                    <div class="review-card">
                        <div class="review-content">
                            ${t.showQuotes?'<span class="quote-mark">"</span>':""}
                            <p class="review-text">${s.review_content}</p>
                            ${t.showQuotes?'<span class="quote-mark">"</span>':""}
                        </div>
                        <div class="reviewer-info">
                            <div class="reviewer-details">
                                <p class="reviewer-name">${s.first_name} ${s.last_name}</p>
                                ${s.reviewer_role?`<p class="reviewer-role">${s.reviewer_role}</p>`:""}
                            </div>
                            <div class="star-rating">
                                ${Array(5).fill(0).map((i,n)=>`
                                    <span class="star ${n<s.star_rating?"filled":""}">\u2605</span>
                                `).join("")}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `,r.appendChild(e)}function a(){return y(this,null,function*(){document.querySelectorAll('.promptreviews-widget[data-widget-type="single"][data-widget]').forEach(o=>y(null,null,function*(){let e=o.getAttribute("data-widget");if(e){o.innerHTML='<div style="text-align:center;padding:2em;color:#888;">Loading widget\u2026</div>';try{let t=yield fetch(`/api/widgets/${e}`);if(!t.ok)throw new Error("Widget not found");let s=yield t.json();c(o,s)}catch(t){o.innerHTML='<div style="color:red;text-align:center;padding:2em;">Failed to load widget.</div>'}}}))})}window.PromptReviews.init=a,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a();function d(r,o=1){r=r.replace(/^#/,""),r.length===3&&(r=r.split("").map(n=>n+n).join(""));let e=parseInt(r,16),t=e>>16&255,s=e>>8&255,i=e&255;return`rgba(${t},${s},${i},${o})`}function v(r,o=.7){r=r.replace(/^#/,""),r.length===3&&(r=r.split("").map(n=>n+n).join(""));let e=parseInt(r,16),t=e>>16&255,s=e>>8&255,i=e&255;return t=Math.round(t+(255-t)*o),s=Math.round(s+(255-s)*o),i=Math.round(i+(255-i)*o),`#${((1<<24)+(t<<16)+(s<<8)+i).toString(16).slice(1)}`}function p(r,o=16){if(typeof r!="number"||isNaN(r))return"";let e="";for(let t=1;t<=5;t++){let s=t<=Math.floor(r),i=!s&&t-.5<=r;s?e+=`<svg width="${o}" height="${o}" viewBox="0 0 20 20" fill="#FBBF24" stroke="#FBBF24" style="display:inline-block;margin-right:2px;"><polygon points="10,1 12.59,7.36 19.51,7.64 14,12.14 15.82,18.99 10,15.27 4.18,18.99 6,12.14 0.49,7.64 7.41,7.36" /></svg>`:i?e+=`<svg width="${o}" height="${o}" viewBox="0 0 20 20" style="display:inline-block;margin-right:2px;"><defs><linearGradient id="half-star-gradient-${t}"><stop offset="50%" stop-color="#FBBF24" /><stop offset="50%" stop-color="#E5E7EB" /></linearGradient></defs><polygon points="10,1 12.59,7.36 19.51,7.64 14,12.14 15.82,18.99 10,15.27 4.18,18.99 6,12.14 0.49,7.64 7.41,7.36" fill="url(#half-star-gradient-${t})" stroke="#FBBF24" /></svg>`:e+=`<svg width="${o}" height="${o}" viewBox="0 0 20 20" fill="#E5E7EB" stroke="#FBBF24" style="display:inline-block;margin-right:2px;"><polygon points="10,1 12.59,7.36 19.51,7.64 14,12.14 15.82,18.99 10,15.27 4.18,18.99 6,12.14 0.49,7.64 7.41,7.36" /></svg>`}return`<span style="display:inline-flex;align-items:center;margin-bottom:4px;">${e}</span>`}function u(r){let o=new Date,e=new Date(r),t=o.getTime()-e.getTime(),s=Math.floor(t/1e3),i=Math.floor(s/60),n=Math.floor(i/60),l=Math.floor(n/24),g=Math.floor(l/7),w=Math.floor(l/30),f=Math.floor(l/365);return f>0?`${f} year${f>1?"s":""} ago`:w>0?`${w} month${w>1?"s":""} ago`:g>0?`${g} week${g>1?"s":""} ago`:l>0?`${l} day${l>1?"s":""} ago`:n>0?`${n} hour${n>1?"s":""} ago`:i>0?`${i} minute${i>1?"s":""} ago`:"just now"}})();})();
